<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>预告</title>
    <url>/posts/224bc55d/</url>
    <content><![CDATA[<p>… … … … …</p>
]]></content>
      <categories>
        <category>预告</category>
      </categories>
      <tags>
        <tag>预告</tag>
      </tags>
  </entry>
  <entry>
    <title>miniconda使用指南</title>
    <url>/posts/69b213e4/</url>
    <content><![CDATA[<p>Conda 是一个开源的包管理和环境管理工具，最初由 Anaconda, Inc. 开发。它主要用于管理软件包和创建隔离的环境，以便在不同的项目中使用不同的依赖版本，而不发生冲突。Conda 支持多种编程语言，包括但不限于 Python、R、Ruby、Lua、Scala、Java 和 C&#x2F;C++ 等。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><blockquote>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/">miniconda清华大学开源软件镜像站</a></p>
<p><a href="https://repo.anaconda.com/miniconda/">miniconda官网下载</a></p>
</blockquote>
<p>选择合适的版本下载</p>
<p><img src="/posts/69b213e4/version.png"></p>
<ol>
<li><p>双击安装包</p>
<p><img src="/posts/69b213e4/setup.png"></p>
</li>
<li><p>同意协议</p>
<p><img src="/posts/69b213e4/agree.png"></p>
<p><img src="/posts/69b213e4/installfor.png"></p>
</li>
<li><p>安装路径</p>
<p><img src="/posts/69b213e4/installpath.png"></p>
</li>
<li><p>环境变量</p>
<p><img src="/posts/69b213e4/addpath.png"></p>
</li>
<li><p>结束</p>
<p><img src="/posts/69b213e4/finish.png"></p>
</li>
<li><p>命令行工具<code>Anaconda Prompt</code></p>
<p><img src="/posts/69b213e4/prompt.png"></p>
</li>
</ol>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>清除缓存</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda clean --all</span><br></pre></td></tr></table></figure>

<p>清理 Conda 的缓存，包括包缓存、环境缓存等，以释放磁盘空间</p>
<h3 id="环境管理"><a href="#环境管理" class="headerlink" title="环境管理"></a>环境管理</h3><ol>
<li><p>创建虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda create -n your_env_name python=x.x</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>your_env_name</code>：虚拟环境名</li>
<li><code>x.x</code>：指定环境<code>python</code>版本，如不指定 Python 版本，Conda 会使用默认的 Python 版本来创建环境。</li>
</ul>
</li>
<li><p>查看虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure>
</li>
<li><p>激活虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">activate your_env_name</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>your_env_name</code>：虚拟环境名</li>
</ul>
</li>
<li><p>关闭虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">deactivate your_env_name</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>your_env_name</code>：虚拟环境名</li>
</ul>
</li>
<li><p>删除虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env remove --name your_env_name --all</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>your_env_name</code>：虚拟环境名</li>
</ul>
</li>
<li><p>克隆环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda create --name myclone --clone myenv</span><br></pre></td></tr></table></figure>

<p>克隆 <code>myenv</code> 环境到一个新的环境 <code>myclone</code></p>
</li>
<li><p>导出环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env export --name myenv &gt; environment.yml</span><br></pre></td></tr></table></figure>

<p>导出 <code>myenv</code> 环境到一个 YAML 文件，方便分享或重新创建环境</p>
</li>
<li><p>导入环境</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env create -f environment.yml</span><br></pre></td></tr></table></figure>

<p>从 YAML 文件创建一个新环境</p>
</li>
</ol>
<h3 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h3><ol>
<li><p>包安装</p>
<p><code>conda</code> or <code>pip</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">activate your_env_name</span><br><span class="line">conda install package_name</span><br></pre></td></tr></table></figure>

<p>安装特定版本包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda install numpy=1.18.5</span><br></pre></td></tr></table></figure>

<p>不激活环境安装</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda install -n your_env_name package_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda update package_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看已安装包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">activate your_env_name</span><br><span class="line">conda list</span><br></pre></td></tr></table></figure>

<p>不激活环境查看</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda list -n your_env_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda search package_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除环境中包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda activate your_env_name</span><br><span class="line">conda remove package_name</span><br></pre></td></tr></table></figure>

<p>不激活环境删除</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda remove -n your_env_name package_name</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><p>打开安装目录<code>C:\Users\username\miniconda3</code>运行<code>Uninstall-Miniconda3.exe</code></p>
]]></content>
      <categories>
        <category>使用指南</category>
      </categories>
      <tags>
        <tag>miniconda</tag>
        <tag>python</tag>
        <tag>使用指南</tag>
        <tag>软件</tag>
      </tags>
  </entry>
  <entry>
    <title>【复刻】简易温湿度仪</title>
    <url>/posts/5a3f2d15/</url>
    <content><![CDATA[<h1 id="1、项目功能介绍"><a href="#1、项目功能介绍" class="headerlink" title="1、项目功能介绍"></a>1、项目功能介绍</h1><p>本项目复刻自<a href="https://www.yuque.com/wldz/jlceda/nhdssggs78punq4a">🔗【立创训练营】桌面温湿度仪👈</a></p>
<p>在原项目基础上，改用0.91寸OLED显示，加入锂电池充放电部分，加入蜂鸣器，通过按键切换显示页面，重新绘制原理图及PCB，减小电路板尺寸，使其更加小巧便携。</p>
<p>项目功能：</p>
<ul>
<li>环境温度、湿度</li>
<li>按键唤醒、休眠</li>
<li>按键切换页面</li>
</ul>
<h1 id="2、项目属性"><a href="#2、项目属性" class="headerlink" title="2、项目属性"></a>2、项目属性</h1><p>此项目复刻自<a href="https://www.yuque.com/wldz/jlceda/nhdssggs78punq4a">🔗【立创训练营】桌面温湿度仪👈</a></p>
<h1 id="3、开源协议"><a href="#3、开源协议" class="headerlink" title="3、开源协议"></a>3、开源协议</h1><p><a href="https://opensource.org/license/GPL-3.0">🔗GPL-3.0👈</a></p>
<h1 id="4、硬件部分"><a href="#4、硬件部分" class="headerlink" title="4、硬件部分"></a>4、硬件部分</h1><p>硬件电路参考官方文档，修改了屏幕显示部分，以及电源部分</p>
<h2 id="主控电路"><a href="#主控电路" class="headerlink" title="主控电路"></a>主控电路</h2><p><img src="https://image.lceda.cn/oshwhub/99b4d68ef5534d9292c076c266368ab1.png"></p>
<h2 id="SHT40电路"><a href="#SHT40电路" class="headerlink" title="SHT40电路"></a>SHT40电路</h2><p><img src="https://image.lceda.cn/oshwhub/eb30093b0271401eadeb9b40db8a8aae.png"></p>
<h2 id="OLED屏幕"><a href="#OLED屏幕" class="headerlink" title="OLED屏幕"></a>OLED屏幕</h2><p><img src="https://image.lceda.cn/oshwhub/ace98303720e4b3db59927a9aba08921.png"></p>
<h2 id="蜂鸣器电路"><a href="#蜂鸣器电路" class="headerlink" title="蜂鸣器电路"></a>蜂鸣器电路</h2><p><img src="https://image.lceda.cn/oshwhub/dedad28e1c564ef28a968bfa0b25b2ec.png"></p>
<h2 id="电源电路"><a href="#电源电路" class="headerlink" title="电源电路"></a>电源电路</h2><p><img src="https://image.lceda.cn/oshwhub/03d06f8cbef642a5a7685dc138b09c29.png"><br><img src="https://image.lceda.cn/oshwhub/03d06f8cbef642a5a7685dc138b09c29.png"></p>
<blockquote>
<p>详情见<a href="https://oshwhub.com/levi_01/simple-temperature-and-humidity-meter">🔗立创开源硬件平台：简易温湿度仪</a></p>
</blockquote>
<h1 id="5、软件部分"><a href="#5、软件部分" class="headerlink" title="5、软件部分"></a>5、软件部分</h1><p>使用<a href="https://www.yuque.com/wldz/jlceda/dqetva01onq5tgdz">🔗stm32cubemx👈</a>软件，快速生成基础代码</p>
<table>
<thead>
<tr>
<th align="center">引脚</th>
<th align="center">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">PB8</td>
<td align="center">SHT40 IIC SCL</td>
</tr>
<tr>
<td align="center">PB9</td>
<td align="center">SHT40 IIC SDA</td>
</tr>
<tr>
<td align="center">PA11</td>
<td align="center">OLED IIC SCL</td>
</tr>
<tr>
<td align="center">PA12</td>
<td align="center">OLED IIC SDA</td>
</tr>
<tr>
<td align="center">PB5</td>
<td align="center">状态按键</td>
</tr>
<tr>
<td align="center">PA8</td>
<td align="center">显示切换</td>
</tr>
<tr>
<td align="center">PB1</td>
<td align="center">电压采集</td>
</tr>
<tr>
<td align="center">PB2</td>
<td align="center">蜂鸣器</td>
</tr>
<tr>
<td align="center">PA13</td>
<td align="center">SWDIO</td>
</tr>
<tr>
<td align="center">PA14</td>
<td align="center">SWCLK</td>
</tr>
<tr>
<td align="center">PC14</td>
<td align="center">RCC_OSC32_IN</td>
</tr>
<tr>
<td align="center">PC15</td>
<td align="center">RCC_OSC32_OUT</td>
</tr>
</tbody></table>
<p>使用i2c1(PB8, PB9)来获取SHT40温湿度数据，i2c2(PA11, PA12)来控制OLED屏幕显示。</p>
<p>OLED屏幕显示使用硬件I2C驱动，移植<a href="https://github.com/olikraus/u8g2">🔗u8g2库👈</a>。</p>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Wa4y1Z7Uc/">🔗B站：STM32 HAL库硬件IIC移植u8g2库👈</a></p>
</blockquote>
<blockquote>
<p>项目工程<a href="https://pan.baidu.com/s/1d8KGuTHAFmlof1lcyZkdMA?pwd=dll9">🔗百度网盘：TEMP_HUMI_U8👈</a></p>
</blockquote>
<h1 id="6、BOM清单"><a href="#6、BOM清单" class="headerlink" title="6、BOM清单"></a>6、BOM清单</h1><blockquote>
<p>详情见<a href="https://oshwhub.com/levi_01/simple-temperature-and-humidity-meter">🔗立创开源硬件平台：简易温湿度仪</a></p>
</blockquote>
<h1 id="7、大赛LOGO验证"><a href="#7、大赛LOGO验证" class="headerlink" title="7、大赛LOGO验证"></a>7、大赛LOGO验证</h1><p><img src="https://image.lceda.cn/oshwhub/9b629f9501d343c3ad9725d09e6e2682.png"></p>
<h1 id="8、END"><a href="#8、END" class="headerlink" title="8、END"></a>8、END</h1><blockquote>
<p><a href="https://www.bilibili.com/video/BV15oeiegEow/">🔗bilibili：简易温湿度仪👈</a><br><a href="https://oshwhub.com/levi_01/simple-temperature-and-humidity-meter">🔗立创开源硬件平台：简易温湿度仪</a><br><a href="https://pan.baidu.com/s/1d8KGuTHAFmlof1lcyZkdMA?pwd=dll9">🔗百度网盘：TEMP_HUMI_U8👈</a></p>
</blockquote>
]]></content>
      <categories>
        <category>复刻</category>
      </categories>
      <tags>
        <tag>立创</tag>
        <tag>STM32</tag>
        <tag>Keil5</tag>
        <tag>STM32CubeMX</tag>
        <tag>HAL</tag>
        <tag>开源</tag>
        <tag>复刻</tag>
        <tag>SHT40</tag>
        <tag>0.91寸OLED</tag>
        <tag>u8g2</tag>
      </tags>
  </entry>
  <entry>
    <title>【立创开源】ESP32_UV_BOX</title>
    <url>/posts/df56fc06/</url>
    <content><![CDATA[<h1 id="ESP-UV-BOX"><a href="#ESP-UV-BOX" class="headerlink" title="ESP_UV_BOX"></a>ESP_UV_BOX</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><a href="https://oshwhub.com/activities/Xiari">🔗夏日征集令</a><br>ESP32-WROOM-32D-N8主控，通过GUVA-S12SD紫外线传感器获取环境紫外线强度；AHT20温湿度传感器获取环境温湿度；BMP280气压传感器获取环境压强；使用拨轮开关切换页面。<br>以下为制作过程记录</p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><ul>
<li>紫外线指数</li>
<li>环境温湿度</li>
<li>气压海拔</li>
<li>简易照明</li>
<li>天气时钟(网络)</li>
<li>.</li>
</ul>
<h2 id="成本"><a href="#成本" class="headerlink" title="成本"></a>成本</h2><p>这里只列出了主要的器件，详情见<a href="https://docs.qq.com/sheet/DTXF2aW5JcUlzY0Na?tab=BB08J2">🔗腾讯文档：BOM_ESP_UV_BOX</a></p>
<table>
<thead>
<tr>
<th>主要元件</th>
<th>价格</th>
</tr>
</thead>
<tbody><tr>
<td>ESP32-WROOM-32D(8MB)</td>
<td>15</td>
</tr>
<tr>
<td>紫外线模块</td>
<td>7.05</td>
</tr>
<tr>
<td>AHT20</td>
<td>1.62</td>
</tr>
<tr>
<td>BMP280</td>
<td>1.04</td>
</tr>
<tr>
<td>四脚拨轮开关</td>
<td>0.85</td>
</tr>
<tr>
<td>CH340K</td>
<td>1.4</td>
</tr>
</tbody></table>
<h1 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h1><blockquote>
<p>硬件设计见<a href="https://oshwhub.com/levi_01/simple-esp-uv-detection-box">立创开源硬件平台</a></p>
</blockquote>
<h2 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h2><blockquote>
<p>存在问题：下载完程序，可以运行，但是板子上电不运行，需要按复位，<a href="https://esp32.com/viewtopic.php?t=17326">&gt;去除BOOT0按键的电容&lt;</a>，解决问题<br>贴片开关的质量也不太行，开关手柄会断🙃<br>侧边按键质量似乎也不太好，按复位有时也没用🙃</p>
</blockquote>
<h2 id="主控电路"><a href="#主控电路" class="headerlink" title="主控电路"></a>主控电路</h2><h3 id="主控"><a href="#主控" class="headerlink" title="主控"></a>主控</h3><p>主控选择ESP32-WROOM-32D-N8，外围电路参考<a href="https://www.espressif.com.cn/sites/default/files/documentation/esp32-wroom-32d_esp32-wroom-32u_datasheet_cn.pdf">官方技术规格书</a>。<br>引出SPI用于控制屏幕，IIC用于控制AHT20和BMP280，ADC用于采集电压值，以及按键控制<br><img src="/posts/df56fc06/970a90b53dde411ea2325a0830c91eed.png" alt="image.png"></p>
<h3 id="自动下载"><a href="#自动下载" class="headerlink" title="自动下载"></a>自动下载</h3><p>串口芯片使用CH340K<br><img src="/posts/df56fc06/7d89effc779e4274b354b0442a294865.png" alt="image.png"></p>
<h2 id="电源电路"><a href="#电源电路" class="headerlink" title="电源电路"></a>电源电路</h2><h3 id="电源切换电路"><a href="#电源切换电路" class="headerlink" title="电源切换电路"></a>电源切换电路</h3><p>使用PMOS，当没有外部电源时使用电池供电，有外部电源输入时不使用电池供电<br><img src="/posts/df56fc06/286190f2fcf24bc4bdd4d62e1ae7b63f.png" alt="image.png"></p>
<h3 id="充电电路"><a href="#充电电路" class="headerlink" title="充电电路"></a>充电电路</h3><p>电池管理使用<a href="https://item.szlcsc.com/772193.html?kw=C725790&fromZone=s">TP4056</a>，电路参考<a href="https://atta.szlcsc.com/upload/public/pdf/source/20231109/CF74897CE79A500F7FE27A45ADCCC631.pdf">TP4056数据手册</a><br><img src="/posts/df56fc06/04faa10853da4b83bcad620b4eaec60e.png" alt="image.png"><br>充电电流如下，根据锂电池参数选择合适的电阻</p>
<table>
<thead>
<tr>
<th>Rprog(K)</th>
<th>Ibat(mA)</th>
</tr>
</thead>
<tbody><tr>
<td>1.2</td>
<td>1000</td>
</tr>
<tr>
<td>2.4</td>
<td>500</td>
</tr>
<tr>
<td>3.0</td>
<td>400</td>
</tr>
<tr>
<td>4.0</td>
<td>300</td>
</tr>
<tr>
<td>6.0</td>
<td>200</td>
</tr>
<tr>
<td>12.0</td>
<td>200</td>
</tr>
</tbody></table>
<h2 id="外设"><a href="#外设" class="headerlink" title="外设"></a>外设</h2><h3 id="按键"><a href="#按键" class="headerlink" title="按键"></a>按键</h3><p>板载一个RESET和BOOT侧边按键，使用拨轮开关作为控制输入<br><img src="/posts/df56fc06/95154bb067354b339ee88efdf9f44841.png" alt="image.png"></p>
<h3 id="TFT"><a href="#TFT" class="headerlink" title="TFT"></a>TFT</h3><p>使用1.8寸TFT屏幕插接，分辨率128x160，屏幕驱动ST7735，屏幕驱动电路参考屏幕原理图，可以通过BLK引脚控制屏幕亮度<br><img src="/posts/df56fc06/658738bf7cb94c4aae2a0b04c17d5cd0.png" alt="image.png"></p>
<h3 id="UV"><a href="#UV" class="headerlink" title="UV"></a>UV</h3><p>紫外线部分电路参考紫外线模块电路设计</p>
<p><img src="/posts/df56fc06/e0976dceda7b422ca7a9527d7b2ea3c3.png" alt="image.png"><br>通过采集电压，根据电压范围，得到紫外线强度</p>
<p><img src="/posts/df56fc06/a360adfc92294010813b1446675f38d3.png" alt="image.png"></p>
<h3 id="AHT20-BMP280"><a href="#AHT20-BMP280" class="headerlink" title="AHT20 BMP280"></a>AHT20 BMP280</h3><p>这两个器件，用烙铁不好焊，加热台方便些<br>AHT20可以检测环境温湿度<br><img src="/posts/df56fc06/4889306f2ecd47be96a50341cb9e54e4.png" alt="image.png"><br>BMP280可以检测大气压，温度，以及海拔高度(由压力和温度计算得到)<br><img src="/posts/df56fc06/78478d91f0de4458a481425c3c324f6f.png" alt="image.png"></p>
<h2 id="面板"><a href="#面板" class="headerlink" title="面板"></a>面板</h2><p>使用立创EDA设计简单的面板</p>
<h1 id="3D外壳"><a href="#3D外壳" class="headerlink" title="3D外壳"></a>3D外壳</h1><p>1.8寸版本<br>本次使用SOLIDWORKS2023建模</p>
<h2 id="立创EDA导出模型"><a href="#立创EDA导出模型" class="headerlink" title="立创EDA导出模型"></a>立创EDA导出模型</h2><p><img src="/posts/df56fc06/68f3f871f74840cbb606b4e4b1bb5266.png" alt="image.png"></p>
<p><img src="/posts/df56fc06/704b2689309b4b698dfd63b14240b134.png" alt="image.png"></p>
<h2 id="SOLIDWORKS"><a href="#SOLIDWORKS" class="headerlink" title="SOLIDWORKS"></a>SOLIDWORKS</h2><p>使用SOLIDWORKS打开导出的<code>step</code>格式文件</p>
<p><img src="/posts/df56fc06/6aab246aaed542ff8417809e7f9d992f.png" alt="image.png"><br>打开后如下图所示，可以看到电路板模型缺少丝印图案</p>
<p><img src="/posts/df56fc06/56bb3bbf915a4040905f02d3ea609aaf.png" alt="image.png"><br>回到PCB工程，打开PCB的2D视图</p>
<p><img src="/posts/df56fc06/8504cd94eda44d3985993ba18a6c7922.png" alt="image.png"><br>导出上下面丝印图<br>如下图点击PCB上表面，选择外观</p>
<p><img src="/posts/df56fc06/e9846749266348c0bd20d668b8c3bc04.png" alt="image.png"><br>选择导出的顶层丝印图</p>
<p><img src="/posts/df56fc06/e564401d3a914499a25c5fe3635eca73.png" alt="image.png"></p>
<p><img src="/posts/df56fc06/32b6a6851a6840719853b7a28ec2dee9.png" alt="image.png"><br>还需要调整丝印的位置和大小，选择映射</p>
<p><img src="/posts/df56fc06/6ad561c3388b47de856ce23cbf653e3e.png" alt="image.png"><br>根据实际情况，调整以下参数</p>
<p><img src="/posts/df56fc06/9ad75608bfe44ad08e2c8bbb698fa1e8.png" alt="image.png"><br>之后便可以开始外壳的建模，最终效果如下<br><img src="/posts/df56fc06/3a0be8a343c244bf81d3b6264f99ca71.png" alt="image.png"></p>
<h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><blockquote>
<p>详细代码见<a href="https://github.com/levi52/ESP32_UV_BOX">levi52@GitHub: ESP32_UV_BOX</a></p>
</blockquote>
<h2 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h2><p>在主界面下设四个功能页，之后各级再设功能分页，主要结构如下<br><img src="/posts/df56fc06/d554d5ff9ca640db81f2d0c2856ac90b.png" alt="image.png"></p>
<blockquote>
<p>设计参考：<br><a href="https://space.bilibili.com/14368720">B站：黑人黑科技</a>的视频<a href="https://www.bilibili.com/video/BV19j41187SF">DIY万能遥控器</a><br><a href="https://oshwhub.com/bukaiyuan/works">OSHWHub: 黑人黑科技</a>的开源工程<a href="https://oshwhub.com/bukaiyuan/ESP32-hang-mu-yao-kong-qi">ESP32 万能遥控器</a></p>
</blockquote>
<p><img src="/posts/df56fc06/db83837706a14e418feb2864e9fb52ca.png" alt="主菜单.png"></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><blockquote>
<p>开发工具：Visual Studio Code + PlatformIO<br>图标：<a href="https://www.iconfont.cn/">iconfont-阿里巴巴</a><br>颜色：<a href="https://rgbcolorpicker.com/565">RGB COLOR PICKER</a><br>中文转换：<a href="https://www.jyshare.com/front-end/3602/">中文转UNICODE</a><br>图片转换：<a href="https://notisrac.github.io/FileToCArray/">FileToCArray</a></p>
</blockquote>
<p>代码结构主要如下</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">ESP32_UV_BOX</span><br><span class="line">│  clearBuildDir<span class="selector-class">.bat</span>   build文件删除</span><br><span class="line">│  default_8MB<span class="selector-class">.csv</span>     存储分区</span><br><span class="line">│  LICENSE             开源协议</span><br><span class="line">│  platformio<span class="selector-class">.ini</span>      开发配置</span><br><span class="line">│  README<span class="selector-class">.md</span>           说明文档</span><br><span class="line">├─assets/              静态文件</span><br><span class="line">├─include</span><br><span class="line">│      README</span><br><span class="line">├─lib                  外部库</span><br><span class="line">│  │  README</span><br><span class="line">│  └─ArduinoZlib </span><br><span class="line">├─<span class="attribute">src</span>                  主要文件</span><br><span class="line">│  │  <span class="selector-tag">button</span><span class="selector-class">.cpp</span>       按键控制</span><br><span class="line">│  │  <span class="selector-tag">button</span><span class="selector-class">.h</span></span><br><span class="line">│  │  <span class="selector-tag">main</span><span class="selector-class">.cpp</span>         主程序</span><br><span class="line">│  │  network<span class="selector-class">.cpp</span>      网络请求</span><br><span class="line">│  │  network<span class="selector-class">.h</span></span><br><span class="line">│  │  sensor<span class="selector-class">.cpp</span>       传感器</span><br><span class="line">│  │  sensor<span class="selector-class">.h</span></span><br><span class="line">│  │  ui<span class="selector-class">.cpp</span>           界面</span><br><span class="line">│  │  ui<span class="selector-class">.h</span></span><br><span class="line">│  ├─<span class="attribute">font</span>/             字体文件</span><br><span class="line">│  └─img/              图片文件</span><br><span class="line">└─test/                测试文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h3><p>屏幕尺寸为1.8寸，分辨率是128x160，屏幕驱动是ST7735，使用<a href="https://github.com/Bodmer/TFT_eSPI">TFT_eSPI</a>库驱动屏幕，所有界面使用<code>TFT_eSPI</code>绘制</p>
<p>使用<code>TFT_eSPI</code>需要修改配置文件<code>User_Setup.h</code>，根据屏幕类型和显示情况修改内容</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ST7735_DRIVER <span class="comment">// 屏幕驱动</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_RGB_ORDER TFT_RGB <span class="comment">// 颜色顺序</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_WIDTH  128  <span class="comment">// 屏幕宽度</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_HEIGHT 160  <span class="comment">// 屏幕高度</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ST7735_GREENTAB2  <span class="comment">// 仅ST7735</span></span></span><br><span class="line"><span class="comment">// #define TFT_INVERSION_ON // 黑白反转</span></span><br><span class="line"><span class="comment">// #define TFT_INVERSION_OFF</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_BL   17 <span class="comment">// 背光引脚</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_MOSI 23</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_SCLK 18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_CS   5  <span class="comment">// Chip select control pin</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_DC    2  <span class="comment">// Data Command control pin</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_RST   4  <span class="comment">// Reset pin (could connect to RST pin)</span></span></span><br><span class="line"><span class="comment">//#define TFT_RST  -1  // Set TFT_RST to -1 if display RESET is connected to ESP32 board RST</span></span><br></pre></td></tr></table></figure>

<p>使用<code>ledc</code>控制引脚输出PWM调节屏幕背光亮度</p>
<h3 id="控制"><a href="#控制" class="headerlink" title="控制"></a>控制</h3><p>使用<code>mathertel/OneButton</code>库来实现按键的控制，分别注册短按，双击和长按函数来实现不同的操作</p>
<p>上下短按为页面切换，中间短按为进入页面，中间长按为返回上一级</p>
<h3 id="传感器"><a href="#传感器" class="headerlink" title="传感器"></a>传感器</h3><h4 id="UV-1"><a href="#UV-1" class="headerlink" title="UV"></a>UV</h4><p>使用S12SD传感器来检测紫外线，然后经过放大，使用ADC采集电压，根据电压范围判断紫外线指数等级</p>
<p>下图为紫外线模块<br><img src="/posts/df56fc06/922ab3f72ef447daafb15dbb491e8795.png" alt="image.png"><br>程序中使用此函数获取紫外线指数</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">uint8_t</span> <span class="title">sensor_uv_data</span><span class="params">(<span class="type">void</span>)</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>图中为Arduino对应的数值，详情见<a href="https://wiki.dfrobot.com.cn/_SKU_SEN0162__UV_Sensor">DFROBOT: UV Sensor</a><br><img src="/posts/df56fc06/6ba2cbb88a73430790e063d3e377f5a7.png" alt="image.png"></p>
</blockquote>
<h4 id="AHT20"><a href="#AHT20" class="headerlink" title="AHT20"></a>AHT20</h4><p>使用<code>dvarrel/AHT20</code>库读取AHT20温湿度传感器的数据<br>主要为如下内容，AHT20数据结构体，初始化函数，以及数据读取函数(返回数据结构体)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AHT20Data</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> temperature;</span><br><span class="line">    <span class="type">float</span> humidity;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sensor_aht20_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function">AHT20Data <span class="title">sensor_aht20_data</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<h4 id="BMP280"><a href="#BMP280" class="headerlink" title="BMP280"></a>BMP280</h4><p>使用<code>seeed-studio/Grove - Barometer Sensor BMP280</code>库读取BMP280传感器的数据<br>主要为如下内容，BMP280数据结构体，初始化函数，以及数据读取函数(返回数据结构体)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">BMP280Data</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> temperature;</span><br><span class="line">    <span class="type">float</span> pressure;</span><br><span class="line">    <span class="type">float</span> altitude;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sensor_bmp280_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function">BMP280Data <span class="title">sensor_bmp280_data</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>在函数<code>bool BMP280::init(void)</code>中注释掉<code>Wire.begin()</code><br>在主程序中上面两个传感器初始化前，要先使用<code>Wire.begin(21, 22);</code>来设置<code>IIC</code>引脚</p>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><h4 id="配网"><a href="#配网" class="headerlink" title="配网"></a>配网</h4><p>初次使用时，会建立如下网络<code>ESP_UV_BOX_WIFI</code>，<br><img src="/posts/df56fc06/c8f8e9414a8448d6b543b0ff38702aef.png" alt="image.png"><br>连接网络，浏览器打开网址<code>192.168.1.1</code>，会出现如下配网页面</p>
<blockquote>
<p>页面代码参考: <a href="https://blog.csdn.net/YANGJIERUN/article/details/129092371">CSDN: 请收藏！分享一个ESP32&#x2F;ESP8266高颜值WIFI配网页面代码-带下拉选择框和中英文版本。文末有arduino配网代码。</a></p>
</blockquote>
<p>一共四个输入框，分别是<code>WIFI SSID</code>, <code>WIFI PASSWORD</code>, <code>Private KEY</code>, <code>Location ID</code></p>
<blockquote>
<p>相关链接：<a href="https://id.qweather.com/#/login?redirect=https%3A%2F%2Fconsole.qweather.com%2F%23%2Fapps&lang=zh">和风天气控制台</a>、<a href="https://docs.qq.com/sheet/DTWNWWU9FeXhwSERG?tab=BB08J2">城市 ID</a></p>
</blockquote>
<p><img src="/posts/df56fc06/3d43aa47c4a04f188f323f635d9e87d4.png" alt="image.png"><br>点击保存后，芯片会重启连接网络</p>
<p>网络配置相关函数如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">wifi_scan</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">wifi_connect</span><span class="params">(<span class="type">int</span> timeOut_s)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">wifi_disconnect</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ap_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">server_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">handleRoot</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">handleConfigWifi</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">handleNotFound</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doClient</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">wifiConfigBySoftAP</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<h4 id="天气时钟"><a href="#天气时钟" class="headerlink" title="天气时钟"></a>天气时钟</h4><p>天气等数据使用和风天气API，免费订阅每天可以有1000次请求</p>
<blockquote>
<p><a href="https://dev.qweather.com/docs/finance/subscription/#comparison">订阅规则</a></p>
</blockquote>
<ul>
<li>实时天气数据使用<a href="https://www.qweather.com/">和风天气</a>的<a href="https://dev.qweather.com/">API</a>，具体代码参考<a href="https://space.bilibili.com/393773788">B站：大聪明的二手脑袋</a>的视频<a href="https://www.bilibili.com/video/BV1wj421Z7Ds">Dudu天气时钟版本更新，全面对接和风天气，2.0版本继续开源</a></li>
<li>时间数据使用<code>arduino-libraries/NTPClient</code>库获取网络时间<br>网络天气相关函数如下</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_weather_now</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_weather_future</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_air</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_city_id</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function">String <span class="title">urlEncode</span><span class="params">(<span class="type">const</span> String&amp; text)</span></span>;</span><br></pre></td></tr></table></figure>

<p>网络相关函数如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">time_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_time</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<h4 id="天气预报"><a href="#天气预报" class="headerlink" title="天气预报"></a>天气预报</h4><p>同上，使用和风天气API，屏幕显示未来六天天气状况</p>
<h4 id="空气质量"><a href="#空气质量" class="headerlink" title="空气质量"></a>空气质量</h4><p>同上，使用和风天气API，屏幕显示颗粒物PM10，颗粒物PM2.5，二氧化氮NO2，二氧化硫SO2，一氧化碳CO，臭氧O3</p>
<h4 id="哔哩哔哩"><a href="#哔哩哔哩" class="headerlink" title="哔哩哔哩"></a>哔哩哔哩</h4><p>通过如下API接口获得JSON格式的数据，使用<a href="https://arduinojson.org/">ArduinoJson</a>库解析获得关注数和粉丝数</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//api.bilibili.com/x/relation/stat?vmid=用户UID</span></span><br></pre></td></tr></table></figure>

<p>可以使用官网提供的<a href="https://arduinojson.org/v7/assistant/#/step1">工具</a>生成解析代码</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ttl&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;mid&quot;</span><span class="punctuation">:</span> <span class="number">378576508</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;following&quot;</span><span class="punctuation">:</span> <span class="number">318</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;whisper&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;follower&quot;</span><span class="punctuation">:</span> <span class="number">56</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>生成的解析代码如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// String input;</span></span><br><span class="line"></span><br><span class="line">JsonDocument doc;</span><br><span class="line"></span><br><span class="line">DeserializationError error = <span class="built_in">deserializeJson</span>(doc, input);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (error) &#123;</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;deserializeJson() failed: &quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(error.<span class="built_in">c_str</span>());</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> code = doc[<span class="string">&quot;code&quot;</span>]; <span class="comment">// 0</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* message = doc[<span class="string">&quot;message&quot;</span>]; <span class="comment">// &quot;0&quot;</span></span><br><span class="line"><span class="type">int</span> ttl = doc[<span class="string">&quot;ttl&quot;</span>]; <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">JsonObject data = doc[<span class="string">&quot;data&quot;</span>];</span><br><span class="line"><span class="type">long</span> data_mid = data[<span class="string">&quot;mid&quot;</span>]; <span class="comment">// 378576508</span></span><br><span class="line"><span class="type">int</span> data_following = data[<span class="string">&quot;following&quot;</span>]; <span class="comment">// 318</span></span><br><span class="line"><span class="type">int</span> data_whisper = data[<span class="string">&quot;whisper&quot;</span>]; <span class="comment">// 0</span></span><br><span class="line"><span class="type">int</span> data_black = data[<span class="string">&quot;black&quot;</span>]; <span class="comment">// 0</span></span><br><span class="line"><span class="type">int</span> data_follower = data[<span class="string">&quot;follower&quot;</span>]; <span class="comment">// 56</span></span><br></pre></td></tr></table></figure>

<h3 id="灯光"><a href="#灯光" class="headerlink" title="灯光"></a>灯光</h3><p>使用<code>fastled/FastLED</code>库驱动板载的一颗WS2812灯珠，暂时只添加不同颜色灯切换功能</p>
<h1 id="实物"><a href="#实物" class="headerlink" title="实物"></a>实物</h1><h2 id="PCB"><a href="#PCB" class="headerlink" title="PCB"></a>PCB</h2><p><img src="/posts/df56fc06/9c97f95d9de94ff3805473966e0f3ed2.png" alt="image.png"></p>
<h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2><p>下图为部分页面<br><img src="/posts/df56fc06/59e9f63003d04a4f83c02cc1ec1dbcde.png" alt="image.png"><br>后续会上传B站视频</p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><p>最后非常感谢立创🥰提供的机会和各种优惠券，帮助我们实现想法，做出实物，参加征集令活动收获颇多，未来继续努力😄</p>
<p><a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Fira+Code&weight=500&size=30&pause=1000&color=8087F7&vCenter=true&random=false&width=435&lines=The+end..." alt="Typing SVG" style="display: inline-block; margin-right: 10px;"></a></p>
<div style="display:flex">
<a href="https://github.com/levi52" target="_blank"><img src="https://img.shields.io/badge/levi52-%40github?style=flat-square&logo=github&logoColor=black&color=%23e0e0e0" style="display: inline-block; margin-right: 10px;"></a>
<a href="https://oshwhub.com/levi_01/works" target="_blank"><img src="https://img.shields.io/badge/levi_01-%40oshwhub?style=flat-square&logo=easyeda&logoColor=white&color=%235588ff" style="display: inline-block; margin-right: 10px;"></a>
<a href="https://space.bilibili.com/378576508" target="_blank"><img src="https://img.shields.io/badge/travi5-%40bilibili?style=flat-square&logo=bilibili&logoColor=white&color=%2301affd" style="display: inline-block; margin-right: 10px;"></a>
<a href="https://blog.csdn.net/Levi_5" target="_blank"><img src="https://img.shields.io/badge/Hi1L-CSDN?style=flat-square&logoColor=white&label=CSDN&color=%23fc5531" style="display: inline-block; margin-right: 10px;"></a> 
<a href="https://levi52.github.io/" target="_blank"><img src="https://img.shields.io/badge/levi52_blog-%40github?style=flat-square&logo=github&logoColor=black&color=%23e0e0e0" style="display: inline-block; margin-right: 10px;"></a>
</div>]]></content>
      <categories>
        <category>ESP32</category>
        <category>开源</category>
      </categories>
      <tags>
        <tag>ESP32</tag>
        <tag>PlatformIO</tag>
        <tag>自制</tag>
        <tag>立创</tag>
        <tag>开源</tag>
        <tag>紫外线</tag>
        <tag>AHT20</tag>
        <tag>BMP280</tag>
        <tag>1.8寸TFT</tag>
        <tag>外壳</tag>
        <tag>面板</tag>
      </tags>
  </entry>
  <entry>
    <title>ESP32S3-输入设备Keypad</title>
    <url>/posts/c4d6bdd0/</url>
    <content><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a><font style="color: #6e9afc">说明</font></h1><blockquote>
<p>硬件：ESP32S3N16R8开发板 + 2.8寸TFT显示屏(ST7789) + 拨轮<br>软件：<font style="color: #36b0f3">Visual Studio Code</font> + <font style="color: #e57200">PlatformIO</font> + Squareline Studio<br>代码：<a href="https://pan.baidu.com/s/1xKbrW781ydQgRGv5lPvfVA?pwd=levi">百度网盘：ESP32S3_KEYPAD(提取码：levi)</a> </p>
</blockquote>
<h1 id="UI界面"><a href="#UI界面" class="headerlink" title="UI界面"></a>UI界面</h1><p>使用<code>Squareline Studio</code>设计如下简单界面</p>
<p><img src="/posts/c4d6bdd0/sq.png" alt="SQ工程"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/sq.png) -->
<p>设置工程导出路径，然后导出文件</p>
<p><img src="/posts/c4d6bdd0/setting.png" alt="工程设置"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/setting.png) -->
<p>导出文件结构如下</p>
<p><img src="/posts/c4d6bdd0/export.png" alt="导出"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/export.png) -->
<h1 id="PlatforIO工程"><a href="#PlatforIO工程" class="headerlink" title="PlatforIO工程"></a>PlatforIO工程</h1><h2 id="复制工程"><a href="#复制工程" class="headerlink" title="复制工程"></a>复制工程</h2><p>复制前面写好的触摸屏工程</p>
<p>删除原工程中的UI文件，将新UI复制过来</p>
<p><img src="/posts/c4d6bdd0/copy.png" alt="创建工程"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/copy.png) -->
<h2 id="优化结构"><a href="#优化结构" class="headerlink" title="优化结构"></a>优化结构</h2><p><code>VS Code</code>打开工程</p>
<p>为了让<code>main.cpp</code>更简洁，这里将屏幕初始化的内容写到单独的<code>screen.cpp</code>文件中，然后在<code>main.cpp</code>中引入<code>screen.h</code>头文件</p>
<p>修改后<code>screen.h</code>文件内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _SCREEN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _SCREEN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bb_captouch.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="comment">// UI</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;./lvgl_gui/ui.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">touch_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_disp_flush</span><span class="params">( <span class="type">lv_disp_drv_t</span> *disp, <span class="type">const</span> <span class="type">lv_area_t</span> *area, <span class="type">lv_color_t</span> *color_p )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_touchpad_read</span><span class="params">( <span class="type">lv_indev_drv_t</span> * indev_driver, <span class="type">lv_indev_data_t</span> * data )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">screen_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><code>screen.cpp</code>内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;screen.h&quot;</span></span></span><br><span class="line"><span class="comment">// GT911引脚</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SDA  18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SCL  8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_INT 45</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_RST 21</span></span><br><span class="line">BBCapTouch bbct;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *szNames[] = &#123;<span class="string">&quot;Unknown&quot;</span>, <span class="string">&quot;FT6x36&quot;</span>, <span class="string">&quot;GT911&quot;</span>, <span class="string">&quot;CST820&quot;</span>&#125;;</span><br><span class="line"><span class="comment">// 屏幕大小</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenWidth  = <span class="number">320</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenHeight = <span class="number">240</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_disp_draw_buf_t</span> draw_buf;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_color_t</span> buf[ screenWidth * <span class="number">10</span> ];</span><br><span class="line">TFT_eSPI tft = <span class="built_in">TFT_eSPI</span>(screenWidth, screenHeight); </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 触摸初始化</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">touch_init</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    bbct.<span class="built_in">init</span>(TOUCH_SDA, TOUCH_SCL, TOUCH_RST, TOUCH_INT);  <span class="comment">// 触摸初始化</span></span><br><span class="line">    <span class="type">int</span> iType = bbct.<span class="built_in">sensorType</span>();  <span class="comment">// 触摸芯片</span></span><br><span class="line">    Serial.<span class="built_in">printf</span>(<span class="string">&quot;Sensor type = %s\n&quot;</span>, szNames[iType]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 触摸读取</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_touchpad_read</span><span class="params">( <span class="type">lv_indev_drv_t</span> * indev_driver, <span class="type">lv_indev_data_t</span> * data )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TOUCHINFO ti;</span><br><span class="line">    <span class="keyword">if</span>(bbct.<span class="built_in">getSamples</span>(&amp;ti))</span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_PR;</span><br><span class="line">        <span class="comment">/*Set the coordinates*/</span></span><br><span class="line">        data-&gt;point.x = ti.y[<span class="number">0</span>];</span><br><span class="line">        data-&gt;point.y = screenHeight - ti.x[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_REL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 显示刷新</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_disp_flush</span><span class="params">( <span class="type">lv_disp_drv_t</span> *disp, <span class="type">const</span> <span class="type">lv_area_t</span> *area, <span class="type">lv_color_t</span> *color_p )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> w = ( area-&gt;x2 - area-&gt;x1 + <span class="number">1</span> );</span><br><span class="line">    <span class="type">uint32_t</span> h = ( area-&gt;y2 - area-&gt;y1 + <span class="number">1</span> );</span><br><span class="line">    tft.<span class="built_in">startWrite</span>();</span><br><span class="line">    tft.<span class="built_in">setAddrWindow</span>( area-&gt;x1, area-&gt;y1, w, h );</span><br><span class="line">    tft.<span class="built_in">pushColors</span>( ( <span class="type">uint16_t</span> * )&amp;color_p-&gt;full, w * h, <span class="literal">true</span> );</span><br><span class="line">    tft.<span class="built_in">endWrite</span>();</span><br><span class="line">    <span class="built_in">lv_disp_flush_ready</span>( disp );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 屏幕初始化</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">screen_init</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tft.<span class="built_in">begin</span>();    <span class="comment">// tft初始化</span></span><br><span class="line">    tft.<span class="built_in">setRotation</span>( <span class="number">1</span> );   <span class="comment">// 屏幕方向</span></span><br><span class="line">    tft.<span class="built_in">fillScreen</span>(TFT_BLACK);</span><br><span class="line">    <span class="built_in">lv_disp_draw_buf_init</span>( &amp;draw_buf, buf, <span class="literal">NULL</span>, screenWidth * <span class="number">10</span> );</span><br><span class="line">    <span class="comment">/*初始化显示*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_disp_drv_t</span> disp_drv;</span><br><span class="line">    <span class="built_in">lv_disp_drv_init</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Change the following line to your display resolution*/</span></span><br><span class="line">    disp_drv.hor_res = screenWidth;</span><br><span class="line">    disp_drv.ver_res = screenHeight;</span><br><span class="line">    disp_drv.flush_cb = my_disp_flush;</span><br><span class="line">    disp_drv.draw_buf = &amp;draw_buf;</span><br><span class="line">    <span class="built_in">lv_disp_drv_register</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Initialize the (dummy) input device driver*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_indev_drv_t</span> indev_drv;</span><br><span class="line">    <span class="built_in">lv_indev_drv_init</span>( &amp;indev_drv );</span><br><span class="line">    indev_drv.type = LV_INDEV_TYPE_POINTER;</span><br><span class="line">    indev_drv.read_cb = my_touchpad_read;</span><br><span class="line">    <span class="built_in">lv_indev_drv_register</span>( &amp;indev_drv );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="输入设备"><a href="#输入设备" class="headerlink" title="输入设备"></a>输入设备</h2><p><a href="https://lvgl.100ask.net/8.2/overview/indev.html">百问网：Input devices（输入设备）</a></p>
<p>打开如下目录文件</p>
<p><img src="/posts/c4d6bdd0/port.png" alt="port indev"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/port.png) -->
<p>打开<code>lv_port_indev_template.c</code>文件后，可以看到一共有五种输入方式</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">lv_indev_t</span> * indev_touchpad;</span><br><span class="line"><span class="type">lv_indev_t</span> * indev_mouse;</span><br><span class="line"><span class="type">lv_indev_t</span> * indev_keypad;</span><br><span class="line"><span class="type">lv_indev_t</span> * indev_encoder;</span><br><span class="line"><span class="type">lv_indev_t</span> * indev_button;</span><br></pre></td></tr></table></figure>

<p>分别是触摸，鼠标，键盘，编码器，按键，具体内容请查看上方<font color="#32a929">百问网lvgl中文文档</font>链接</p>
<blockquote>
<p>本次使用的是<code>keypad</code>来控制屏幕上的控件</p>
</blockquote>
<h2 id="Keypad设置"><a href="#Keypad设置" class="headerlink" title="Keypad设置"></a>Keypad设置</h2><p>在<code>lv_port_indev_template.c</code>中关于<code>keypad</code>一共有这几个函数</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">keypad_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">keypad_read</span><span class="params">(<span class="type">lv_indev_drv_t</span> * indev_drv, <span class="type">lv_indev_data_t</span> * data)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">keypad_get_key</span><span class="params">(<span class="type">void</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>分别是键盘初始化，键盘回调，键值获取</p>
<h3 id="screen-h"><a href="#screen-h" class="headerlink" title="screen.h"></a>screen.h</h3><p>把<code>lv_port_indev_template.c</code>中这三个函数声明复制到<code>screen.h</code>中，修改如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _SCREEN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _SCREEN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="comment">// UI</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;./lvgl_gui/ui.h&quot;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">lv_indev_t</span> * indev_keypad1;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">lv_group_t</span> * group1;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_disp_flush</span><span class="params">( <span class="type">lv_disp_drv_t</span> *disp, <span class="type">const</span> <span class="type">lv_area_t</span> *area, <span class="type">lv_color_t</span> *color_p )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">screen_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_init</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_read</span><span class="params">(<span class="type">lv_indev_drv_t</span> * indev_drv, <span class="type">lv_indev_data_t</span> * data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title">keypad_get_key</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="screen-cpp"><a href="#screen-cpp" class="headerlink" title="screen.cpp"></a>screen.cpp</h3><p>把<code>lv_port_indev_template.c</code>中三个函数的定义复制到<code>screen.cpp</code>中</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*------------------</span></span><br><span class="line"><span class="comment"> * Keypad</span></span><br><span class="line"><span class="comment"> * -----------------*/</span></span><br><span class="line"><span class="comment">/*Initialize your keypad*/</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_init</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*Your code comes here*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*Will be called by the library to read the mouse*/</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_read</span><span class="params">(<span class="type">lv_indev_drv_t</span> * indev_drv, <span class="type">lv_indev_data_t</span> * data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">uint32_t</span> last_key = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*Get the current x and y coordinates*/</span></span><br><span class="line">    <span class="built_in">mouse_get_xy</span>(&amp;data-&gt;point.x, &amp;data-&gt;point.y);</span><br><span class="line">    <span class="comment">/*Get whether the a key is pressed and save the pressed key*/</span></span><br><span class="line">    <span class="type">uint32_t</span> act_key = <span class="built_in">keypad_get_key</span>();</span><br><span class="line">    <span class="keyword">if</span>(act_key != <span class="number">0</span>) &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_PR;</span><br><span class="line">        <span class="comment">/*Translate the keys to LVGL control characters according to your key definitions*/</span></span><br><span class="line">        <span class="keyword">switch</span>(act_key) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                act_key = LV_KEY_NEXT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                act_key = LV_KEY_PREV;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                act_key = LV_KEY_LEFT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                act_key = LV_KEY_RIGHT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                act_key = LV_KEY_ENTER;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last_key = act_key;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_REL;</span><br><span class="line">    &#125;</span><br><span class="line">    data-&gt;key = last_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*Get the currently being pressed key.  0 if no key is pressed*/</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title">keypad_get_key</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*Your code comes here*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在我自制的ESP32S3N16R8开发板中使用的是如下图所示的<a href="https://item.szlcsc.com/300043.html">多功能开关</a></p>
<p><img src="/posts/c4d6bdd0/key.png" alt="多功能开关"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/key.png) -->
<p>原理图如下，三个按键被下拉，IO为低电平，当按键按下时IO将检测到高电平</p>
<p><img src="/posts/c4d6bdd0/keyd.png" alt="原理图"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/keyd.png) -->
<p>在<code>screen.cpp</code>中最开始定义如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">lv_indev_drv_t</span> indev_drv;</span><br><span class="line"><span class="type">lv_indev_t</span> * indev_keypad1;</span><br><span class="line"><span class="type">lv_group_t</span> * group1;</span><br><span class="line"><span class="comment">// 按键引脚</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> btn1 5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> btn2 6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> btn3 7</span></span><br></pre></td></tr></table></figure>

<p><code>keypad_init</code>内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_init</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*Your code comes here*/</span></span><br><span class="line">    <span class="built_in">pinMode</span>(btn1, INPUT); <span class="comment">//左</span></span><br><span class="line">    <span class="built_in">pinMode</span>(btn2, INPUT); <span class="comment">//确定</span></span><br><span class="line">    <span class="built_in">pinMode</span>(btn3, INPUT); <span class="comment">//右</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>keypad_read</code>内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">keypad_read</span><span class="params">(<span class="type">lv_indev_drv_t</span> * indev_drv, <span class="type">lv_indev_data_t</span> * data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">uint32_t</span> last_key = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*Get whether the a key is pressed and save the pressed key*/</span></span><br><span class="line">    <span class="type">uint32_t</span> act_key = <span class="built_in">keypad_get_key</span>();</span><br><span class="line">    <span class="keyword">if</span>(act_key != <span class="number">0</span>) &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_PR;</span><br><span class="line">        <span class="comment">/*Translate the keys to LVGL control characters according to your key definitions*/</span></span><br><span class="line">        <span class="keyword">switch</span>(act_key) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                act_key = LV_KEY_NEXT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                act_key = LV_KEY_PREV;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                act_key = LV_KEY_LEFT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                act_key = LV_KEY_RIGHT;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                act_key = LV_KEY_ENTER;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last_key = act_key;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_REL;</span><br><span class="line">    &#125;</span><br><span class="line">    data-&gt;key = last_key;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>keypad_get_key</code>内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title">keypad_get_key</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*Your code comes here*/</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">digitalRead</span>(btn1) == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 下一个</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">digitalRead</span>(btn2) == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>; <span class="comment">// 上一个</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">digitalRead</span>(btn3) == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>; <span class="comment">// 确定</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下一步修改<code>screen_init</code>内容如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">screen_init</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tft.<span class="built_in">begin</span>();    <span class="comment">// tft初始化</span></span><br><span class="line">    tft.<span class="built_in">setRotation</span>( <span class="number">1</span> );   <span class="comment">// 屏幕方向</span></span><br><span class="line">    <span class="built_in">lv_disp_draw_buf_init</span>( &amp;draw_buf, buf, <span class="literal">NULL</span>, screenWidth * <span class="number">10</span> );</span><br><span class="line">    <span class="comment">/*初始化显示*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_disp_drv_t</span> disp_drv;</span><br><span class="line">    <span class="built_in">lv_disp_drv_init</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Change the following line to your display resolution*/</span></span><br><span class="line">    disp_drv.hor_res = screenWidth;</span><br><span class="line">    disp_drv.ver_res = screenHeight;</span><br><span class="line">    disp_drv.flush_cb = my_disp_flush;</span><br><span class="line">    disp_drv.draw_buf = &amp;draw_buf;</span><br><span class="line">    <span class="built_in">lv_disp_drv_register</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Initialize your keypad or keyboard if you have*/</span></span><br><span class="line">    <span class="built_in">keypad_init</span>();</span><br><span class="line">    <span class="comment">/*Register a keypad input device*/</span></span><br><span class="line">    <span class="built_in">lv_indev_drv_init</span>(&amp;indev_drv);</span><br><span class="line">    indev_drv.type = LV_INDEV_TYPE_KEYPAD;</span><br><span class="line">    indev_drv.read_cb = keypad_read;</span><br><span class="line">    indev_keypad1 = <span class="built_in">lv_indev_drv_register</span>(&amp;indev_drv);</span><br><span class="line">    <span class="comment">/*Later you should create group(s) with `lv_group_t * group = lv_group_create()`,</span></span><br><span class="line"><span class="comment">     *add objects to the group with `lv_group_add_obj(group, obj)`</span></span><br><span class="line"><span class="comment">     *and assign this input device to group to navigate in it:</span></span><br><span class="line"><span class="comment">     *`lv_indev_set_group(indev_keypad1, group);`*/</span></span><br><span class="line">    group1 = <span class="built_in">lv_group_create</span>();</span><br><span class="line">    <span class="built_in">lv_indev_set_group</span>(indev_keypad1, group1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要修改如下</p>
<ul>
<li><p><code>indev_drv.type</code>输入设备类型改为<code>LV_INDEV_TYPE_KEYPAD</code></p>
</li>
<li><p><code>indev_drv.read_cb</code>回调函数改为<code>keypad_read</code></p>
</li>
<li><p><code>lv_indev_drv_register(&amp;indev_drv)</code>赋值给最开始定义的<code>indev_keypad1</code></p>
</li>
<li><p>创建组<code>group1 = lv_group_create()lv_group_create()</code></p>
</li>
<li><p>将组与输入设备关联<code>lv_indev_set_group(indev_keypad1, group1)</code></p>
</li>
</ul>
<h2 id="添加对象"><a href="#添加对象" class="headerlink" title="添加对象"></a>添加对象</h2><p>只有将控件对象添加到组中，才能通过<code>keypad</code>控制</p>
<p>打开如下目录界面文件<code>lvgl_gui/screens/ui_mainpage.c</code></p>
<p>可以看到在设计界面时一共添加了四个控件</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ui_Button2</span><br><span class="line">ui_Switch2</span><br><span class="line">ui_Switch1</span><br><span class="line">ui_Dropdown2</span><br></pre></td></tr></table></figure>

<p>在<code>#include &quot;../ui.h&quot;</code>下添加如下代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">lv_group_t</span> * group1;</span><br></pre></td></tr></table></figure>

<p>在<code>ui_mainpage_screen_init</code>函数中最后添加如下代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">lv_group_add_obj(group1, ui_Button2);</span><br><span class="line">lv_group_add_obj(group1, ui_Switch2);</span><br><span class="line">lv_group_add_obj(group1, ui_Switch1);</span><br><span class="line">lv_group_add_obj(group1, ui_Dropdown2);</span><br><span class="line">lv_group_focus_obj(ui_Button2);</span><br></pre></td></tr></table></figure>

<h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><p>因为前面优化了代码结构，这里还需要在<code>main.cpp</code>中引入<code>screen.h</code></p>
<p>修改代码如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lvgl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;freertos/FreeRTOS.h&gt;</span></span></span><br><span class="line"><span class="comment">// SCREEN</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;./screen.h&quot;</span></span></span><br><span class="line"><span class="comment">// UI</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;./lvgl_gui/ui.h&quot;</span></span></span><br><span class="line"><span class="comment">// 任务</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lvgl_task</span><span class="params">(<span class="type">void</span> *pt)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Serial.<span class="built_in">begin</span>( <span class="number">115200</span> ); <span class="comment">// 串口初始化</span></span><br><span class="line">    <span class="built_in">lv_init</span>();  <span class="comment">// lvgl初始化</span></span><br><span class="line">    <span class="built_in">screen_init</span>(); <span class="comment">// 屏幕初始化</span></span><br><span class="line">    <span class="built_in">ui_init</span>();  <span class="comment">// UI初始化</span></span><br><span class="line">    <span class="built_in">xTaskCreatePinnedToCore</span>(lvgl_task, <span class="string">&quot;lvgl display&quot;</span>, <span class="number">1024</span> * <span class="number">15</span>, <span class="literal">NULL</span>, <span class="number">2</span>, <span class="literal">NULL</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lvgl_task</span><span class="params">(<span class="type">void</span> *pt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">lv_timer_handler</span>(); <span class="comment">/* let the GUI do its work */</span></span><br><span class="line">        <span class="built_in">vTaskDelay</span>(<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p>修改程序后，编译烧录</p>
<p><img src="/posts/c4d6bdd0/key1.png" alt="拨轮"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/key1.png) -->
<p><img src="/posts/c4d6bdd0/screen.png" alt="显示"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/screen.png) -->
<p><img src="/posts/c4d6bdd0/switch.gif" alt="切换"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/switch.gif) -->
<p><img src="/posts/c4d6bdd0/enter.gif" alt="选中"></p>
<!-- ![](https://gitee.com/levi-05/pic1/raw/master/esp32s3_keypad/enter.gif) -->
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><center> 2024 <font color="#00bcd9">Levi5</font></center>]]></content>
      <categories>
        <category>ESP32</category>
        <category>教程</category>
      </categories>
      <tags>
        <tag>ESP32</tag>
        <tag>PlatformIO</tag>
        <tag>lvgl</tag>
        <tag>2.8寸TFT</tag>
        <tag>多功能开关</tag>
        <tag>自制</tag>
        <tag>Squareline Studio</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHub Profile</title>
    <url>/posts/7f6b7f24/</url>
    <content><![CDATA[<h1 id="GitHub-主页指南"><a href="#GitHub-主页指南" class="headerlink" title="GitHub 主页指南"></a>GitHub 主页指南</h1><blockquote>
<p>user_name: GitHub用户名(levi52)</p>
</blockquote>
<h2 id="访问次数"><a href="#访问次数" class="headerlink" title="访问次数"></a>访问次数</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">Visitor Count</span>](<span class="link">https://profile-counter.glitch.me/user_name/count.svg</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GitHub-Readme-Stats"><a href="#GitHub-Readme-Stats" class="headerlink" title="GitHub Readme Stats"></a>GitHub Readme Stats</h2><p><a href="https://github.com/anuraghazra/github-readme-stats">github-readme-stats: :zap: Dynamically generated stats for your github readmes</a></p>
<h3 id="常用语言"><a href="#常用语言" class="headerlink" title="常用语言"></a>常用语言</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">![Top Langs</span>](<span class="link">https://github-readme-stats.vercel.app/api/top-langs/?username=user_name</span>)](<span class="link">https://github.com/user_name/github-readme-stats</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">![Top Langs</span>](<span class="link">https://github-readme-stats.vercel.app/api/top-langs/?username=user_name&amp;layout=compact</span>)](<span class="link">https://github.com/user_name/github-readme-stats</span>)</span><br></pre></td></tr></table></figure>

<h3 id="仓库状态"><a href="#仓库状态" class="headerlink" title="仓库状态"></a>仓库状态</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">user_name&#x27;s GitHub stats</span>](<span class="link">https://github-readme-stats.vercel.app/api?username=user_name&amp;show_icons=true&amp;theme=tokyonight</span>)</span><br><span class="line">![<span class="string">GitHub followers</span>](<span class="link"></span>)</span><br></pre></td></tr></table></figure>

<h2 id="shield图标"><a href="#shield图标" class="headerlink" title="shield图标"></a>shield图标</h2><p><a href="https://shields.io/">Shields</a></p>
<p><a href="https://dev.to/envoy_/150-badges-for-github-pnk">📛 Awesome Badges</a></p>
<p><a href="https://badgen.net/">badgen</a></p>
<p><img src="/posts/7f6b7f24/levi52.svg" alt="GitHub followers"></p>
<p><img src="/posts/7f6b7f24/tool-pycharm-green.svg" alt="Static Badge"></p>
<p><img src="/posts/7f6b7f24/GitHub-100000.svg" alt="Github"></p>
<h3 id="静态"><a href="#静态" class="headerlink" title="静态"></a>静态</h3><p><a href="https://shields.io/badges/static-badge">Static Badge</a></p>
<ul>
<li><p><code>badgeContent</code> string – <font color="red">REQUIRED</font></p>
<p>标签, (可选) 信息, 颜色. <code>-</code>连接</p>
<p>示例：立创-EDA-#f7f7f7</p>
</li>
<li><p><code>style</code> string</p>
<p>可选参数：<code>flat</code>,<code>flat-square</code>,<code>plastic</code>,<code>for-the-badge</code>,<code>social</code></p>
<p>默认：<code>flat</code></p>
<p>示例：<code>flat</code></p>
</li>
<li><p><code>logo</code> string</p>
<p>可选logo：<a href="https://github.com/simple-icons/simple-icons/blob/master/slugs.md">simple-icons&#x2F;slugs.md</a></p>
<p>示例：easyeda</p>
</li>
<li><p><code>logoColor</code> string</p>
<p>logo颜色，支持hex, rgb, rgba, hsl, hsla and css</p>
<p>示例：ffffff</p>
</li>
<li><p><code>label</code>  string</p>
<p>左边文本</p>
<p>示例：立创</p>
</li>
<li><p><code>labelColor</code>  string</p>
<p>左边背景颜色，支持 hex, rgb, rgba, hsl, hsla and css</p>
<p>示例：5487ff</p>
</li>
<li><p><code>color</code>  string</p>
<p>右边背景颜色，支持hex, rgb, rgba, hsl, hsla and css</p>
<p>示例：f7f7f7</p>
</li>
<li><p><code>cacheSeconds</code>  string</p>
<p>HTTP缓存生存期(应用规则来推断每个徽章的默认值，低于默认值指定的任何值都将被忽略)。</p>
<p>示例: 3600</p>
</li>
<li><p><code>link</code>  string[]</p>
<p>指定单击徽章的左&#x2F;右链接。</p>
<p>示例：<a href="https://lceda.cn/">https://lceda.cn/</a></p>
</li>
</ul>
<blockquote>
<p>效果: <img src="/%E7%AB%8B%E5%88%9B-EDA-#f7f7f7style=flat&logo=easyeda&logoColor=ffffff&label=%E7%AB%8B%E5%88%9B&labelColor=5487ff&color=f7f7f7&cacheSeconds=3600&link=https://lceda.svg" alt="Static Badge"></p>
</blockquote>
<p><img src="/posts/7f6b7f24/image-20240202114236931.png" alt="image-20240202114236931"></p>
<h2 id="主页编辑器"><a href="#主页编辑器" class="headerlink" title="主页编辑器"></a>主页编辑器</h2><p><a href="https://profilinator.rishav.dev/">Github Profilinator - GitHub Profile README Generator </a></p>
<h2 id="图标"><a href="#图标" class="headerlink" title="图标"></a>图标</h2><h3 id="📱-Contact"><a href="#📱-Contact" class="headerlink" title="📱 Contact"></a>📱 Contact</h3><p><img src="https://img.shields.io/badge/Gmail-D14836?style=for-the-badge&logo=gmail&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Line-00C300?style=for-the-badge&logo=line&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Outlook-0078D4?style=for-the-badge&logo=microsoft-outlook&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Telegram-2CA5E0?style=for-the-badge&logo=telegram&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/WeChat-07C160?style=for-the-badge&logo=wechat&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/WhatsApp-25D366?style=for-the-badge&logo=whatsapp&logoColor=white"></p>
<h3 id="🤜🤛-Group"><a href="#🤜🤛-Group" class="headerlink" title="🤜🤛 Group"></a>🤜🤛 Group</h3><p><img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Teams-6264A7?style=for-the-badge&logo=microsoft-teams&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Zoom-2D8CFF?style=for-the-badge&logo=zoom&logoColor=white"></p>
<p><img src="https://aleen42.github.io/badges/src/reddit.svg"></p>
<h3 id="👨-Social"><a href="#👨-Social" class="headerlink" title="👨 Social"></a>👨 Social</h3><p><img src="https://img.shields.io/badge/Codepen-000000?style=for-the-badge&logo=codepen&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Element-0DBD8B?style=for-the-badge&logo=element&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Facebook-1877F2?style=for-the-badge&logo=facebook&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/GitLab-330F63?style=for-the-badge&logo=gitlab&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Instagram-E4405F?style=for-the-badge&logo=instagram&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/-LeetCode-FFA116?style=for-the-badge&logo=LeetCode&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Reddit-FF4500?style=for-the-badge&logo=reddit&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Snapchat-FFFC00?style=for-the-badge&logo=snapchat&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/TikTok-000000?style=for-the-badge&logo=tiktok&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Twitter-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white"></p>
<h3 id="🛒-Store"><a href="#🛒-Store" class="headerlink" title="🛒 Store"></a>🛒 Store</h3><p><img src="https://img.shields.io/badge/App_Store-0D96F6?style=for-the-badge&logo=app-store&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Google_Play-414141?style=for-the-badge&logo=google-play&logoColor=white"></p>
<h3 id="💻-OS"><a href="#💻-OS" class="headerlink" title="💻 OS"></a>💻 OS</h3><p><img src="https://img.shields.io/badge/Android-3DDC84?style=for-the-badge&logo=android&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Cent%20OS-262577?style=for-the-badge&logo=CentOS&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Debian-A81D33?style=for-the-badge&logo=debian&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/iOS-000000?style=for-the-badge&logo=ios&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Linux-FCC624?style=for-the-badge&logo=linux&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/mac%20os-000000?style=for-the-badge&logo=apple&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Red%20Hat-EE0000?style=for-the-badge&logo=redhat&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Windows-0078D6?style=for-the-badge&logo=windows&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Windows_95-008080?style=for-the-badge&logo=windows-95&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Windows_XP-003399?style=for-the-badge&logo=windows-xp&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/-%23ffffff?style=for-the-badge&logo=harmonyos&logoColor=ffffff&label=Harmony%20OS&labelColor=000000&color=ffffff&cacheSeconds=3600"></p>
<h3 id="📝-Blog"><a href="#📝-Blog" class="headerlink" title="📝 Blog"></a>📝 Blog</h3><p><img src="https://img.shields.io/badge/Wordpress-21759B?style=for-the-badge&logo=wordpress&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Blogger-FF5722?style=for-the-badge&logo=blogger&logoColor=white"></p>
<h3 id="🎞-Streaming"><a href="#🎞-Streaming" class="headerlink" title="🎞 Streaming"></a>🎞 Streaming</h3><p><img src="https://img.shields.io/badge/Netflix-E50914?style=for-the-badge&logo=netflix&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Twitch-9146FF?style=for-the-badge&logo=twitch&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/YouTube-FF0000?style=for-the-badge&logo=youtube&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/YouTube_Gaming-FF0000?style=for-the-badge&logo=youtube-gaming&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/-%23ffffff?style=for-the-badge&logo=bilibili&logoColor=ffffff&label=bilibili&labelColor=ff6a9b&color=ffffff&cacheSeconds=3600&link=https%3A%2F%2Fwww.bilibili.com%2F"></p>
<h3 id="❤-Funding"><a href="#❤-Funding" class="headerlink" title="❤ Funding"></a>❤ Funding</h3><p><img src="https://img.shields.io/badge/alipay-00A1E9?style=for-the-badge&logo=alipay&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/amazon%20pay-F79114?style=for-the-badge&logo=amazon%20pay&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/apple%20pay-007AFF?style=for-the-badge&logo=apple%20pay&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Buy_Me_A_Coffee-FFDD00?style=for-the-badge&logo=buy-me-a-coffee&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/G%20pay-2875E3?style=for-the-badge&logo=googlepay&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/PayPal-00457C?style=for-the-badge&logo=paypal&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/samsung%20pay-1D49C0?style=for-the-badge&logo=samsung%20pay&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/sponsor-30363D?style=for-the-badge&logo=GitHub-Sponsors&logoColor=#white"></p>
<h3 id="🎶-Sound"><a href="#🎶-Sound" class="headerlink" title="🎶 Sound"></a>🎶 Sound</h3><p><img src="https://img.shields.io/badge/apple%20music-F34E68?style=for-the-badge&logo=apple%20music&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Apple_Podcasts-9933CC?style=for-the-badge&logo=apple-podcasts&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/iheart-A80025?style=for-the-badge&logo=iheartradio&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/SoundCloud-FF3300?style=for-the-badge&logo=soundcloud&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Spotify-1ED760?&style=for-the-badge&logo=spotify&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/YouTube_Music-FF0000?style=for-the-badge&logo=youtube-music&logoColor=white"></p>
<h3 id="🍔-Food"><a href="#🍔-Food" class="headerlink" title="🍔 Food"></a>🍔 Food</h3><p><img src="https://img.shields.io/badge/KFC-F40027?style=for-the-badge&logo=kfc&logoColor=white"></p>
<h3 id="☁-Cloud"><a href="#☁-Cloud" class="headerlink" title="☁ Cloud"></a>☁ Cloud</h3><p><img src="https://img.shields.io/badge/Alibaba_Cloud-FF6A00?style=for-the-badge&logo=alibabacloud&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Amazon_AWS-FF9900?style=for-the-badge&logo=amazonaws&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Azure_DevOps-0078D7?style=for-the-badge&logo=azure-devops&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Azure_Functions-0062AD?style=for-the-badge&logo=azure-functions&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Cloudflare-F38020?style=for-the-badge&logo=Cloudflare&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/GitHub_Actions-2088FF?style=for-the-badge&logo=github-actions&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Google_Cloud-4285F4?style=for-the-badge&logo=google-cloud&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/microsoft%20azure-0089D6?style=for-the-badge&logo=microsoft-azure&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Oracle-F80000?style=for-the-badge&logo=oracle&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/Vercel-000000?style=for-the-badge&logo=vercel&logoColor=white"></p>
<h3 id="⚡-Database"><a href="#⚡-Database" class="headerlink" title="⚡ Database"></a>⚡ Database</h3><p><img src="https://img.shields.io/badge/MongoDB-4EA94B?style=for-the-badge&logo=mongodb&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/MySQL-005C84?style=for-the-badge&logo=mysql&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Oracle-F80000?style=for-the-badge&logo=Oracle&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/redis-%23DD0031.svg?&style=for-the-badge&logo=redis&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/SQLite-07405E?style=for-the-badge&logo=sqlite&logoColor=white"></p>
<h3 id="👩‍💻-IDE"><a href="#👩‍💻-IDE" class="headerlink" title="👩‍💻 IDE"></a>👩‍💻 IDE</h3><p><img src="https://img.shields.io/badge/NI_Multisim-white?style=flat&logo=multisim&logoColor=%237b75a7&labelColor=%23f7f7f7&color=%2321af90"></p>
<p><img src="https://img.shields.io/badge/Keil_uVision5-white?style=flat&logo=armkeil&logoColor=%23fcfefd&labelColor=%23357643"></p>
<p><img src="https://img.shields.io/badge/Keil-uVision5-white?style=flat&label=Keil&labelColor=%23357643&color=%23fcfefd"></p>
<p><img src="https://img.shields.io/badge/Android_Studio-3DDC84?style=for-the-badge&logo=android-studio&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Arduino_IDE-00979D?style=for-the-badge&logo=arduino&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/CLion-000000?style=for-the-badge&logo=clion&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Colab-F9AB00?style=for-the-badge&logo=googlecolab&color=525252"></p>
<p><img src="https://img.shields.io/badge/Eclipse-2C2255?style=for-the-badge&logo=eclipse&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Notepad++-90E59A.svg?style=for-the-badge&logo=notepad%2B%2B&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/PyCharm-000000.svg?&style=for-the-badge&logo=PyCharm&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/sublime_text-%23575757.svg?&style=for-the-badge&logo=sublime-text&logoColor=important"></p>
<p><img src="https://img.shields.io/badge/VIM-%2311AB00.svg?&style=for-the-badge&logo=vim&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Visual_Studio-5C2D91?style=for-the-badge&logo=visual%20studio&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Visual_Studio_Code-0078D4?style=for-the-badge&logo=visual%20studio%20code&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/WebStorm-000000?style=for-the-badge&logo=WebStorm&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/espressif-E7352C?style=for-the-badge&logo=espressif&logoColor=white"></p>
<h3 id="💻-Terminal"><a href="#💻-Terminal" class="headerlink" title="💻 Terminal"></a>💻 Terminal</h3><p><img src="https://img.shields.io/badge/GIT-E44C30?style=for-the-badge&logo=git&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/powershell-5391FE?style=for-the-badge&logo=powershell&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/windows%20terminal-4D4D4D?style=for-the-badge&logo=windows%20terminal&logoColor=white"></p>
<h3 id="🌐-Web-Browsers"><a href="#🌐-Web-Browsers" class="headerlink" title="🌐 Web Browsers"></a>🌐 Web Browsers</h3><p><img src="https://img.shields.io/badge/Google_chrome-4285F4?style=for-the-badge&logo=Google-chrome&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Firefox_Browser-FF7139?style=for-the-badge&logo=Firefox-Browser&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Edge-0078D7?style=for-the-badge&logo=Microsoft-edge&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Safari-FF1B2D?style=for-the-badge&logo=Safari&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Tor_Browser-7D4698?style=for-the-badge&logo=Tor-Browser&logoColor=white"></p>
<h3 id="🎨🎨Designer"><a href="#🎨🎨Designer" class="headerlink" title="🎨🎨Designer"></a>🎨🎨Designer</h3><p><img src="https://aleen42.github.io/badges/src/photoshop.svg"></p>
<p><img src="https://aleen42.github.io/badges/src/illustrator.svg"></p>
<p><img src="https://aleen42.github.io/badges/src/after_effects.svg"></p>
<p><img src="https://aleen42.github.io/badges/src/premiere.svg"></p>
<h3 id="Made-with"><a href="#Made-with" class="headerlink" title="Made with"></a>Made with</h3><p><img src="http://ForTheBadge.com/images/badges/made-with-python.svg"></p>
<p><img src="https://img.shields.io/badge/Made%20with-Jupyter-orange?style=for-the-badge&logo=Jupyter"></p>
<p><img src="https://img.shields.io/badge/Made%20with-Go-1f425f.svg"></p>
<p><img src="https://img.shields.io/badge/Made%20with-Markdown-1f425f.svg"></p>
<p><img src="https://img.shields.io/badge/Made%20with-LaTeX-1f425f.svg"></p>
<p><img src="https://img.shields.io/badge/Made%20for-VSCode-1f425f.svg"></p>
<p><img src="http://ForTheBadge.com/images/badges/built-with-love.svg"></p>
<p><img src="http://ForTheBadge.com/images/badges/built-by-developers.svg"></p>
<h3 id="GitHub-Stats"><a href="#GitHub-Stats" class="headerlink" title="GitHub Stats"></a>GitHub Stats</h3><p><img src="https://img.shields.io/github/license/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/realese/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/commits-since/{username}/{repo-name}/{version}.svg"></p>
<p><img src="https://img.shields.io/github/downloads/{username}/{repo-name}/total.svg"></p>
<p><img src="https://img.shields.io/github/forks/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/stars/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/watchers/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/followers/{username}.svg?style=social&label=Follow&maxAge=2592000"></p>
<p><img src="https://img.shields.io/github/issues/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/issues-closed/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/issues-pr/{username}/{repo-name}.svg"></p>
<p><img src="https://img.shields.io/github/issues-pr-closed/{username}/{repo-name}.svg"></p>
<p><img src="https://github-readme-stats.vercel.app/api?username={username}&theme=blue-green"></p>
<p><img src="https://github-readme-stats.vercel.app/api?username={username}&theme=blue-green"></p>
<p><img src="https://github-readme-stats.vercel.app/api/top-langs/?username={username}&theme=blue-green"></p>
<p><img src="https://starchart.cc/{username}/{repo}.svg"></p>
<p><img src></p>
<p><img src></p>
<h3 id="🚀-skill"><a href="#🚀-skill" class="headerlink" title="🚀 skill"></a>🚀 skill</h3><p><img src="https://img.shields.io/badge/C%23-239120?style=for-the-badge&logo=c-sharp&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/HTML-239120?style=for-the-badge&logo=html5&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/CSS-239120?&style=for-the-badge&logo=css3&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/.NET-5C2D91?style=for-the-badge&logo=.net&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"></p>
<p><img src="https://img.shields.io/badge/Node.js-43853D?style=for-the-badge&logo=node.js&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/JavaScript-323330?style=for-the-badge&logo=javascript&logoColor=F7DF1E"></p>
<p><img src="https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=html5&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=css3&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Sass-CC6699?style=for-the-badge&logo=sass&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Python-14354C?style=for-the-badge&logo=python&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/C-00599C?style=for-the-badge&logo=c&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/C%2B%2B-00599C?style=for-the-badge&logo=c%2B%2B&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/C%23-239120?style=for-the-badge&logo=c-sharp&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/PHP-777BB4?style=for-the-badge&logo=php&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/R-276DC3?style=for-the-badge&logo=r&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Kotlin-0095D5?&style=for-the-badge&logo=kotlin&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Go-00ADD8?style=for-the-badge&logo=go&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Rust-000000?style=for-the-badge&logo=rust&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Lua-2C2D72?style=for-the-badge&logo=lua&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Markdown-000000?style=for-the-badge&logo=markdown&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Express.js-404D59?style=for-the-badge"></p>
<p><img src="https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB"></p>
<p><img src="https://img.shields.io/badge/React_Native-20232A?style=for-the-badge&logo=react&logoColor=61DAFB"></p>
<p><img src="https://img.shields.io/badge/Vue.js-35495E?style=for-the-badge&logo=vue.js&logoColor=4FC08D"></p>
<p><img src="https://img.shields.io/badge/Tailwind_CSS-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Bootstrap-563D7C?style=for-the-badge&logo=bootstrap&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/jQuery-0769AD?style=for-the-badge&logo=jquery&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Django-092E20?style=for-the-badge&logo=django&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Flask-000000?style=for-the-badge&logo=flask&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Flutter-02569B?style=for-the-badge&logo=flutter&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/MySQL-00000F?style=for-the-badge&logo=mysql&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/MongoDB-4EA94B?style=for-the-badge&logo=mongodb&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/SQLite-07405E?style=for-the-badge&logo=sqlite&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Unity-100000?style=for-the-badge&logo=unity&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Amazon_AWS-232F3E?style=for-the-badge&logo=amazon-aws&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Google_Cloud-4285F4?style=for-the-badge&logo=google-cloud&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Azure-0089D6?style=for-the-badge&logo=microsoft-azure&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Excel-217346?style=for-the-badge&logo=microsoft-excel&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_PowerPoint-B7472A?style=for-the-badge&logo=microsoft-powerpoint&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Office-D83B01?style=for-the-badge&logo=microsoft-office&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft_Word-2B579A?style=for-the-badge&logo=microsoft-word&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Microsoft-666666?style=for-the-badge&logo=microsoft&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Powershell-2CA5E0?style=for-the-badge&logo=powershell&logoColor=white"></p>
<h3 id="💻-Workspace-Specs"><a href="#💻-Workspace-Specs" class="headerlink" title="💻 Workspace Specs"></a>💻 Workspace Specs</h3><p><img src="https://img.shields.io/badge/NVIDIA-GTX1650-76B900?style=for-the-badge&logo=nvidia&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/AMD-Radeon_RX_5500-ED1C24?style=for-the-badge&logo=amd&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Intel-Core_i5_10th-0071C5?style=for-the-badge&logo=intel&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/AMD-Ryzen_7_3800X-ED1C24?style=for-the-badge&logo=amd&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Windows-ASUS_Zenbook_3-0078D6?style=for-the-badge&logo=windows&logoColor=white"></p>
<p><img src="https://img.shields.io/badge/Apple-MacBook_Pro_2012-999999?style=for-the-badge&logo=apple&logoColor=white"></p>
]]></content>
      <categories>
        <category>GitHub</category>
        <category>教程</category>
      </categories>
      <tags>
        <tag>GitHub</tag>
        <tag>icon</tag>
      </tags>
  </entry>
  <entry>
    <title>安信可Ai-M61-32S环境搭建 + 点灯</title>
    <url>/posts/17ee55dc/</url>
    <content><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><blockquote>
<p>硬件：安信可Ai-M61-32S开发板<br>软件：<font style="color: #36b0f3">Visual Studio Code</font><br>视频：<a href="https://www.bilibili.com/video/BV1Vi421k7Mu">bilibili: 【Ai-M61】安信可Ai-M61-32S环境搭建+祖传点灯</a> </p>
</blockquote>
<h1 id="一、软件安装"><a href="#一、软件安装" class="headerlink" title="一、软件安装"></a>一、软件安装</h1><p>👉<a href="https://bbs.ai-thinker.com/forum.php?mod=viewthread&tid=282&extra=page=2&_dsign=7fea3002"><strong><font color="#12507b">零基础搭建小安派Windows 开发环境</font></strong></a>👈</p>
<h1 id="二、克隆仓库"><a href="#二、克隆仓库" class="headerlink" title="二、克隆仓库"></a>二、克隆仓库</h1><p>在项目文件夹右键，选择<code>open git bash here</code>，输入如下指令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://gitee.com/Ai-Thinker-Open/AiPi-Open-Kits.git -b master</span><br></pre></td></tr></table></figure>
<p>开始从<code>gitee</code>克隆仓库</p>
<p><img src="/posts/17ee55dc/download.gif"></p>
<p>等待下载，完成如下图所示</p>
<p><img src="/posts/17ee55dc/downloaded.png"></p>
<h1 id="三、拉取M61的SDK子模块"><a href="#三、拉取M61的SDK子模块" class="headerlink" title="三、拉取M61的SDK子模块"></a>三、拉取M61的SDK子模块</h1><h2 id="1-修改文件"><a href="#1-修改文件" class="headerlink" title="1. 修改文件"></a>1. 修改文件</h2><p>由于<code>github</code>访问较慢，在拉取 SDK 之前，需要修改子模块仓库位置。</p>
<p>进入 <code>AiPi-Open-Kits</code> 中，用文本打开 <code>.gitmodules</code> 文件 <strong>url</strong> 参数中的 <code>github.com</code> 改成 <code>gitee.com</code>：</p>
<p><img src="/posts/17ee55dc/gitee.gif"></p>
<p><img src="/posts/17ee55dc/gitee.png"></p>
<h2 id="2-拉取文件"><a href="#2-拉取文件" class="headerlink" title="2. 拉取文件"></a>2. 拉取文件</h2><p>继续输入如下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd AiPi-Open-Kits/</span><br><span class="line">git submodule init</span><br><span class="line">git submodule update</span><br></pre></td></tr></table></figure>

<p><img src="/posts/17ee55dc/submodule1.png"></p>
<h1 id="四、拉取-M61-SDK-中的子模块"><a href="#四、拉取-M61-SDK-中的子模块" class="headerlink" title="四、拉取 M61 SDK 中的子模块"></a>四、拉取 M61 SDK 中的子模块</h1><h2 id="1-拉取文件"><a href="#1-拉取文件" class="headerlink" title="1. 拉取文件"></a>1. 拉取文件</h2><p>继续输入如下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd aithinker_Ai-M6X_SDK/</span><br><span class="line">git submodule init</span><br><span class="line">git submodule update</span><br></pre></td></tr></table></figure>

<p><img src="/posts/17ee55dc/submodule2.png"></p>
<h2 id="2-克隆工具链"><a href="#2-克隆工具链" class="headerlink" title="2. 克隆工具链"></a>2. 克隆工具链</h2><p>完成后，输入如下指令，克隆适用 Windows 的编译工具链</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://gitee.com/bouffalolab/toolchain_gcc_t-head_windows.git -b master</span><br></pre></td></tr></table></figure>

<p><img src="/posts/17ee55dc/toolchain.png"></p>
<h1 id="五、环境变量设置"><a href="#五、环境变量设置" class="headerlink" title="五、环境变量设置"></a>五、环境变量设置</h1><h2 id="1-打开环境变量"><a href="#1-打开环境变量" class="headerlink" title="1. 打开环境变量"></a>1. 打开环境变量</h2><p>打开电脑高级系统设置，点击环境变量</p>
<p><img src="/posts/17ee55dc/env.png"></p>
<p>在弹出的窗口中选择系统变量里的<code>Path</code>，点击编辑</p>
<p><img src="/posts/17ee55dc/sysenv.png"></p>
<h2 id="2-添加环境变量"><a href="#2-添加环境变量" class="headerlink" title="2. 添加环境变量"></a>2. 添加环境变量</h2><p>选择新建，然后点击浏览，添加如下路径</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">aithinker_Ai-M6X_SDK\toolchain_gcc_t-head_windows\bin</span><br><span class="line">aithinker_Ai-M6X_SDK\tools\make</span><br><span class="line">aithinker_Ai-M6X_SDK\tools\ninja</span><br></pre></td></tr></table></figure>

<p><img src="/posts/17ee55dc/env1.png"></p>
<p>添加完成后，如下图</p>
<p><img src="/posts/17ee55dc/env2.png"></p>
<p>注意还需要把 <code>aithinker_Ai-M6X_SDK\tools\make</code> 路径上移到最高层</p>
<h2 id="3-验证"><a href="#3-验证" class="headerlink" title="3. 验证"></a>3. 验证</h2><p>验证配置是否成功</p>
<p>在桌面按住 <code>shift</code> 键点击 <code>鼠标右键</code> 选择<code>在此处打开PowersShell窗口</code></p>
<p><code>Windows PowerShell</code>窗口中，输入如下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">make -v</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">riscv64-unknown-elf-gcc -v</span><br></pre></td></tr></table></figure>

<p>成功时，输出如下图</p>
<p><img src="/posts/17ee55dc/powershell.png"></p>
<h1 id="六、编译程序"><a href="#六、编译程序" class="headerlink" title="六、编译程序"></a>六、编译程序</h1><h2 id="1-打开源码"><a href="#1-打开源码" class="headerlink" title="1. 打开源码"></a>1. 打开源码</h2><p>使用<code>VS Code</code>打开前面克隆的源码</p>
<p><img src="/posts/17ee55dc/vscode1.png"></p>
<p>选择<code>AiPi-Eyes-DU</code>文件夹，右键选择<code>在集成终端中打开</code></p>
<p><img src="/posts/17ee55dc/vscode2.png"></p>
<h2 id="2-编译程序"><a href="#2-编译程序" class="headerlink" title="2. 编译程序"></a>2. 编译程序</h2><p>输入<code>make</code>命令</p>
<p><img src="/posts/17ee55dc/vscode3.png"></p>
<h2 id="3-处理报错"><a href="#3-处理报错" class="headerlink" title="3. 处理报错"></a>3. 处理报错</h2><p>编译报错</p>
<p><img src="/posts/17ee55dc/error1.png"></p>
<p>根据报错，打开如下文件</p>
<p><img src="/posts/17ee55dc/edit1.png"></p>
<p>注释掉如下两行代码，然后再次执行<code>make</code>指令</p>
<p><img src="/posts/17ee55dc/edit2.png"></p>
<p><img src="/posts/17ee55dc/edit2.png"></p>
<h1 id="七、烧录程序"><a href="#七、烧录程序" class="headerlink" title="七、烧录程序"></a>七、烧录程序</h1><h2 id="1-查看端口"><a href="#1-查看端口" class="headerlink" title="1. 查看端口"></a>1. 查看端口</h2><p>打开<code>设备管理器</code>，查看端口</p>
<p><img src="/posts/17ee55dc/serial.png"></p>
<h2 id="2-烧录"><a href="#2-烧录" class="headerlink" title="2. 烧录"></a>2. 烧录</h2><p>可以看到端口为<code>COM19</code>，回到编辑器，在终端输入如下指令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">make flash COMX=COM19</span><br></pre></td></tr></table></figure>

<p><img src="/posts/17ee55dc/success.png"></p>
<p>烧写开发板前，先按住烧录按键不松手再按一下复位按键，然后松手进入烧录模式</p>
<p><a href="https://docs.ai-thinker.com/_media/en/ai-m61-32s-kit_v1.1.0%E8%A7%84%E6%A0%BC%E4%B9%A620230324.pdf"><strong><font color="#12507b">ai-m61-32s-kit_v1.1.0规格书</font></strong></a></p>
<p><img src="/posts/17ee55dc/boot.png"></p>
<h1 id="八、效果演示"><a href="#八、效果演示" class="headerlink" title="八、效果演示"></a>八、效果演示</h1><p><img src="/posts/17ee55dc/led.gif"></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><center> 2024 <font color="#00bcd9">Levi5</font></center>]]></content>
      <categories>
        <category>Ai-M61-32S</category>
        <category>教程</category>
      </categories>
      <tags>
        <tag>Ai-M61-32S</tag>
        <tag>安信可</tag>
        <tag>环境搭建</tag>
        <tag>点灯</tag>
      </tags>
  </entry>
  <entry>
    <title>ESP32S3N8R8 + Squareline_Studio设计移植</title>
    <url>/posts/b97be97c/</url>
    <content><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><blockquote>
<p>硬件：<a href="https://lckfb.com/">立创ESP32S3R8N8开发板</a> + 2.8寸TFT显示屏(ST7789) + 电容触摸(GT911)<br>软件：<font style="color: #36b0f3">Visual Studio Code</font> + <font style="color: #e57200">PlatformIO</font>+ <font style="color: #dc4040">Squareline Studio</font><br>代码：<a href="https://pan.baidu.com/s/1HlfkJY-gq79WkFS29hg6Wg?pwd=levi">百度网盘：ESP32S3_SQ(提取码：levi)</a><br>代码：<a href="https://pan.baidu.com/s/1nwjB5gQ_fUmbdlNZjtprzQ?pwd=levi">百度网盘：ESP32S3_SERVO(提取码：levi)</a><br>视频：<a href="https://www.bilibili.com/video/BV1CC411J72J">bilibili: 【ESP32】初试Squareline Studio设计 简单控制屏幕亮度</a><br>视频：<a href="https://www.bilibili.com/video/BV1kJ4m1P73e">bilibili: 【ESP32】Squareline Studio新增界面+移植过程 - 简单控制舵机</a><br>博客：<a href="https://blog.csdn.net/Levi_5/article/details/138243662">CSDN: 【ESP32】立创ESP32S3N8R8开发板+2.8寸TFT电容触摸屏+Squareline Studio+PlatformIO</a></p>
</blockquote>
<h1 id="Squareline-Studio"><a href="#Squareline-Studio" class="headerlink" title="Squareline Studio"></a>Squareline Studio</h1><h2 id="设计UI"><a href="#设计UI" class="headerlink" title="设计UI"></a>设计UI</h2><p><img src="/posts/b97be97c/Squareline.png" alt="image-"></p>
<h2 id="导出文件"><a href="#导出文件" class="headerlink" title="导出文件"></a>导出文件</h2><ul>
<li><p>工程设置<br>按如下所示设置工程，<code>Project Export Root</code>和<code>UI Files Export Path</code>路径可以选择为LVGL工程目录下新建的<code>export</code>文件夹<br><img src="/posts/b97be97c/project_setting.png"><br><img src="/posts/b97be97c/project_setting1.png"></p>
</li>
<li><p>Export<br><img src="/posts/b97be97c/export.png"></p>
</li>
</ul>
<h1 id="PlatformIO"><a href="#PlatformIO" class="headerlink" title="PlatformIO"></a>PlatformIO</h1><h2 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h2><ul>
<li><p>导出文件<br>以下为<font color="#dc4140">Squareline Studio</font>导出的文件<br><img src="/posts/b97be97c/file_folder.png" alt="image-"></p>
</li>
<li><p>移植文件<br>资源文件复制到<font color="#dc4140">src&#x2F;lvgl_gui</font><br><img src="/posts/b97be97c/copy_file.png" alt="image-"></p>
</li>
</ul>
<h2 id="LVGL"><a href="#LVGL" class="headerlink" title="LVGL"></a>LVGL</h2><ul>
<li>修改lvgl<br>修改lvgl_conf.h，如下所示，关闭案例编译<br><img src="/posts/b97be97c/lvgl_conf.png" alt="image-"></li>
</ul>
<h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><ul>
<li><p>添加头文件</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui.h&quot;</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>UI初始化<br>删去之前LVGL官方案例的内容，添加如下代码</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ui_init</span>();</span><br></pre></td></tr></table></figure>
<p><img src="/posts/b97be97c/ui_init.png" alt="image-"></p>
</li>
<li><p>lvgl显示</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">lvgl_task</span><span class="params">(<span class="type">void</span> *pt)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        lv_timer_handler(); <span class="comment">/* let the GUI do its work */</span></span><br><span class="line"></span><br><span class="line">        vTaskDelay(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><code>setup()</code>中创建任务</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">xTaskCreatePinnedToCore(lvgl_task, <span class="string">&quot;lvgl display&quot;</span>, <span class="number">1024</span> * <span class="number">15</span>, <span class="literal">NULL</span>, <span class="number">2</span>, <span class="literal">NULL</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="编译下载"><a href="#编译下载" class="headerlink" title="编译下载"></a>编译下载</h2><p><img src="/posts/b97be97c/S1.png" alt="image-"><br><img src="/posts/b97be97c/S2.jpg" alt="image-"><br><img src="/posts/b97be97c/S3.jpg" alt="image-"></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><center> 2024 <font color="#00bcd9">Levi5</font></center>
]]></content>
      <categories>
        <category>ESP32</category>
        <category>教程</category>
      </categories>
      <tags>
        <tag>ESP32</tag>
        <tag>PlatformIO</tag>
        <tag>lvgl</tag>
        <tag>2.8寸TFT</tag>
        <tag>Squareline Studio</tag>
        <tag>触摸屏</tag>
        <tag>立创</tag>
      </tags>
  </entry>
  <entry>
    <title>ESP32S3N8R8 + lvgl测试官方案例</title>
    <url>/posts/2c4e27ec/</url>
    <content><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a><font style="color: #6e9afc">说明</font></h1><blockquote>
<p>硬件：立创ESP32S3R8N8开发板 + 2.8寸TFT显示屏(ST7789) + 电容触摸(GT911)<br>软件：<font style="color: #36b0f3">Visual Studio Code</font> + <font style="color: #e57200">PlatformIO</font><br>代码：<a href="https://pan.baidu.com/s/1tPKpCQTtXrIsN9fd9mheDQ?pwd=levi">百度网盘：ESP32S3_GT911TOUCH(提取码：levi)</a><br>视频：<a href="https://www.bilibili.com/video/BV1AT421m7Xa">bilibili: 【ESP32】2.8寸电容触摸屏(ST7789+GT911) lvgl 案例测试</a><br>博客：<a href="https://blog.csdn.net/Levi_5/article/details/137572195">CSDN: 【ESP32】立创ESP32S3R8N8开发板+2.8寸TFT电容触摸屏ST7789+GT911+PlatformIO</a></p>
</blockquote>
<h1 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a><font style="color: #e57200">新建工程</font></h1><ul>
<li><p>点击侧边<code>PlatformIO</code>插件，新建工程<br><img src="/posts/2c4e27ec/open.png"></p>
</li>
<li><p>依次设置工程名，开发板，框架<br><img src="/posts/2c4e27ec/project.png"></p>
</li>
</ul>
<h1 id="屏幕测试"><a href="#屏幕测试" class="headerlink" title="屏幕测试"></a><font style="color: #c16eff">屏幕测试</font></h1><h2 id="添加TFT-eSPI"><a href="#添加TFT-eSPI" class="headerlink" title="添加TFT_eSPI"></a>添加TFT_eSPI</h2><ul>
<li><p>添加屏幕驱动库<code>TFT_eSPI</code>，按如下图顺序<br><img src="/posts/2c4e27ec/TFT_eSPI.png"><br><img src="/posts/2c4e27ec/TFTINSTALL.png"></p>
</li>
<li><p>添加TFT_eSPI到工程<br><img src="/posts/2c4e27ec/ADDTFT.png"></p>
</li>
<li><p>打开配置文件，可以看到已成功添加库<br><img src="/posts/2c4e27ec/TFTINSTALLED.png"></p>
</li>
</ul>
<h2 id="修改TFT-eSPI"><a href="#修改TFT-eSPI" class="headerlink" title="修改TFT_eSPI"></a>修改TFT_eSPI</h2><ul>
<li><p>打开<code>.pio\libdeps\esp32-s3-devkitc-1\TFT_eSPI\User_Setup.h</code>文件<br><img src="/posts/2c4e27ec/opensetup.png"></p>
</li>
<li><p>根据屏幕驱动芯片解注释</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Only define one driver, the other ones must be commented out</span></span><br><span class="line"><span class="comment">// #define ILI9341_DRIVER       // Generic driver for common displays</span></span><br><span class="line"><span class="comment">//#define ILI9341_2_DRIVER     // Alternative ILI9341 driver, see https://github.com/Bodmer/TFT_eSPI/issues/1172</span></span><br><span class="line"><span class="comment">//#define ST7735_DRIVER      // Define additional parameters below for this display</span></span><br><span class="line"><span class="comment">//#define ILI9163_DRIVER     // Define additional parameters below for this display</span></span><br><span class="line"><span class="comment">//#define S6D02A1_DRIVER</span></span><br><span class="line"><span class="comment">//#define RPI_ILI9486_DRIVER // 20MHz maximum SPI</span></span><br><span class="line"><span class="comment">//#define HX8357D_DRIVER</span></span><br><span class="line"><span class="comment">//#define ILI9481_DRIVER</span></span><br><span class="line"><span class="comment">//#define ILI9486_DRIVER</span></span><br><span class="line"><span class="comment">//#define ILI9488_DRIVER     // WARNING: Do not connect ILI9488 display SDO to MISO if other devices share the SPI bus (TFT SDO does NOT tristate when CS is high)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ST7789_DRIVER      <span class="comment">// Full configuration option, define additional parameters below for this display</span></span></span><br><span class="line"><span class="comment">//#define ST7789_2_DRIVER    // Minimal configuration option, define additional parameters below for this display</span></span><br><span class="line"><span class="comment">//#define R61581_DRIVER</span></span><br><span class="line"><span class="comment">//#define RM68140_DRIVER</span></span><br><span class="line"><span class="comment">//#define ST7796_DRIVER</span></span><br><span class="line"><span class="comment">//#define SSD1351_DRIVER</span></span><br><span class="line"><span class="comment">//#define SSD1963_480_DRIVER</span></span><br><span class="line"><span class="comment">//#define SSD1963_800_DRIVER</span></span><br><span class="line"><span class="comment">//#define SSD1963_800ALT_DRIVER</span></span><br><span class="line"><span class="comment">//#define ILI9225_DRIVER</span></span><br><span class="line"><span class="comment">//#define GC9A01_DRIVER</span></span><br></pre></td></tr></table></figure>

<ul>
<li>根据屏幕大小设置宽高</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// For ST7789, ST7735, ILI9163 and GC9A01 ONLY, define the pixel width and height in portrait orientation</span></span><br><span class="line"><span class="comment">// #define TFT_WIDTH  80</span></span><br><span class="line"><span class="comment">// #define TFT_WIDTH  128</span></span><br><span class="line"><span class="comment">// #define TFT_WIDTH  172 // ST7789 172 x 320</span></span><br><span class="line"><span class="comment">// #define TFT_WIDTH  170 // ST7789 170 x 320</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_WIDTH  240 <span class="comment">// ST7789 240 x 240 and 240 x 320</span></span></span><br><span class="line"><span class="comment">// #define TFT_HEIGHT 160</span></span><br><span class="line"><span class="comment">// #define TFT_HEIGHT 128</span></span><br><span class="line"><span class="comment">// #define TFT_HEIGHT 240 // ST7789 240 x 240</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_HEIGHT 320 <span class="comment">// ST7789 240 x 320</span></span></span><br><span class="line"><span class="comment">// #define TFT_HEIGHT 240 // GC9A01 240 x 240</span></span><br></pre></td></tr></table></figure>

<ul>
<li>根据连线设置引脚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ### EDIT THE PIN NUMBERS IN THE LINES FOLLOWING TO SUIT YOUR ESP32 SETUP   ###</span></span><br><span class="line"><span class="comment">// For ESP32 Dev board (only tested with ILI9341 display)</span></span><br><span class="line"><span class="comment">// The hardware SPI can be mapped to any pins</span></span><br><span class="line"><span class="comment">//#define TFT_MISO 19</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_MOSI 17</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_SCLK 18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_CS   15  <span class="comment">// Chip select control pin</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_DC    16  <span class="comment">// Data Command control pin</span></span></span><br><span class="line"><span class="comment">//#define TFT_RST   4  // Reset pin (could connect to RST pin)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_RST  -1  <span class="comment">// Set TFT_RST to -1 if display RESET is connected to ESP32 board RST</span></span></span><br></pre></td></tr></table></figure>

<h2 id="修改main-cpp"><a href="#修改main-cpp" class="headerlink" title="修改main.cpp"></a>修改main.cpp</h2><p>在屏幕上从上到下分别显示<font style="color: #ff0000">红</font><font style="color: #00ff00">绿</font><font style="color: #0000ff">蓝</font>三色，以及<font style="background: #8c8c8c;color: #ffffff">白色</font>文字，用来测试屏幕颜色显示是否正常。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> <span class="comment">// Hardware-specific library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_GREY 0x5AEB</span></span><br><span class="line">TFT_eSPI tft = <span class="built_in">TFT_eSPI</span>();       <span class="comment">// Invoke custom library</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  tft.<span class="built_in">init</span>();</span><br><span class="line">  tft.<span class="built_in">setRotation</span>(<span class="number">0</span>);</span><br><span class="line">  tft.<span class="built_in">fillScreen</span>(TFT_GREY);</span><br><span class="line">  tft.<span class="built_in">setTextColor</span>(TFT_WHITE, TFT_GREY);  <span class="comment">// Adding a background colour erases previous text automatically</span></span><br><span class="line">  tft.<span class="built_in">fillRect</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">240</span>,<span class="number">50</span>,TFT_RED);</span><br><span class="line">  tft.<span class="built_in">fillRect</span>(<span class="number">0</span>,<span class="number">50</span>,<span class="number">240</span>,<span class="number">50</span>,TFT_GREEN);</span><br><span class="line">  tft.<span class="built_in">fillRect</span>(<span class="number">0</span>,<span class="number">100</span>,<span class="number">240</span>,<span class="number">50</span>,TFT_BLUE);</span><br><span class="line">  tft.<span class="built_in">drawCentreString</span>(<span class="string">&quot;Time flies&quot;</span>,<span class="number">120</span>,<span class="number">260</span>,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// put your main code here, to run repeatedly:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下载调试"><a href="#下载调试" class="headerlink" title="下载调试"></a>下载调试</h2><ul>
<li><p>编译下载<br><img src="/posts/2c4e27ec/load.png"></p>
</li>
<li><p>根据屏幕显示情况修改<code>User_Setup.h</code>文件</p>
</li>
</ul>
<p>如果颜色反转(白色显示为黑色)，如下图所示，则取消下一个注释，尝试两个选项，其中一个选项应该纠正反转。<br><img src="/posts/2c4e27ec/image-20240410132437581.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// If colours are inverted (white shows as black) then uncomment one of the next</span></span><br><span class="line"><span class="comment">// 2 lines try both options, one of the options should correct the inversion.</span></span><br><span class="line"><span class="comment">// #define TFT_INVERSION_ON</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TFT_INVERSION_OFF</span></span><br></pre></td></tr></table></figure>
<p>修改后，如下图所示，白色正常显示，但是RGB顺序存在问题<br><img src="/posts/2c4e27ec/image-20240410132701414.png"></p>
<p>仅对于ST7735, ST7789和ILI9341，如果显示器上的蓝色和红色交换，则定义颜色顺序，一次尝试一个选项来找到显示的正确颜色顺序</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// For ST7735, ST7789 and ILI9341 ONLY, define the colour order IF the blue and red are swapped on your display</span></span><br><span class="line"><span class="comment">// Try ONE option at a time to find the correct colour order for your display</span></span><br><span class="line"><span class="comment">//  #define TFT_RGB_ORDER TFT_RGB  // Colour order Red-Green-Blue</span></span><br><span class="line"> <span class="meta">#<span class="keyword">define</span> TFT_RGB_ORDER TFT_BGR  <span class="comment">// Colour order Blue-Green-Red</span></span></span><br></pre></td></tr></table></figure>
<p>修改后，如下图所示，RGB顺序正常<br><img src="/posts/2c4e27ec/image-20240410132744241.png"></p>
<h1 id="LVGL测试"><a href="#LVGL测试" class="headerlink" title="LVGL测试"></a><font style="color: #6c9ba6">LVGL测试</font></h1><h2 id="添加LVGL"><a href="#添加LVGL" class="headerlink" title="添加LVGL"></a>添加LVGL</h2><ul>
<li><p>根据实际情况，选择lvgl版本<br><img src="/posts/2c4e27ec/lvgl.png"><br>![](lvglinstall.png” style&#x3D;”zoom:67%;” &gt;</p>
</li>
<li><p>添加lvgl到工程<br>![](lvglinstalled.png” style&#x3D;”zoom:67%;” &gt;</p>
</li>
</ul>
<h2 id="修改LVGL"><a href="#修改LVGL" class="headerlink" title="修改LVGL"></a>修改LVGL</h2><ul>
<li><p>打开<code>.pio\libdeps\esp32-s3-devkitc-1\lvgl\lv_conf_template.h</code>文件</p>
<p>将此文件重命名为<code>lv_conf.h</code></p>
</li>
</ul>
<p>![](lvconf.png” style&#x3D;”zoom:67%;” &gt;</p>
<ul>
<li>使能lvgl</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* clang-format off */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 1 <span class="comment">/*Set it to &quot;1&quot; to enable content*/</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> LV_CONF_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_CONF_H</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置周期</li>
</ul>
<p>默认显示刷新周期。LVG将重新绘制改变的区域与这个周期时间<br>输入设备读取周期毫秒</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*Default display refresh period. LVG will redraw changed areas with this period time*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_DISP_DEF_REFR_PERIOD 1      <span class="comment">/*[ms]*/</span></span></span><br><span class="line"><span class="comment">/*Input device read period in milliseconds*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_INDEV_DEF_READ_PERIOD 1     <span class="comment">/*[ms]*/</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>心跳使能</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*Use a custom tick source that tells the elapsed time in milliseconds.</span></span><br><span class="line"><span class="comment"> *It removes the need to manually update the tick with `lv_tick_inc()`)*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_TICK_CUSTOM 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> LV_TICK_CUSTOM</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使能测试案例</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*Show some widget. It might be required to increase `LV_MEM_SIZE` */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_USE_DEMO_WIDGETS 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> LV_USE_DEMO_WIDGETS</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LV_DEMO_WIDGETS_SLIDESHOW 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>更改文件路径</p>
<p>将<code>.pio\libdeps\esp32-s3-devkitc-1\lvgl\demos</code>文件夹移动至<code>.pio\libdeps\esp32-s3-devkitc-1\lvgl\src\demos</code></p>
</li>
<li><p>修改main.cpp</p>
<p>将<code>.pio\libdeps\esp32-s3-devkitc-1\lvgl\examples\arduino\LVGL_Arduino\LVGL_Arduino.ino</code>文件内容复制</p>
<ul>
<li>设置头文件</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lvgl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> <span class="comment">// Hardware-specific library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;demos/lv_demos.h&quot;</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置宽高</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenWidth  = <span class="number">320</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenHeight = <span class="number">240</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改类型</li>
</ul>
<p><code>lv_disp_t</code>修改为<code>lv_disp_drv_t</code></p>
<p><code>lv_indev_t</code>修改为<code>lv_indev_drv_t</code></p>
<ul>
<li>注释掉触摸部分</li>
</ul>
</li>
</ul>
<h2 id="修改完成"><a href="#修改完成" class="headerlink" title="修改完成"></a>修改完成</h2><p>最终<code>main.cpp</code>文件内容如下</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lvgl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> <span class="comment">// Hardware-specific library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;demos/lv_demos.h&quot;</span></span></span><br><span class="line"><span class="comment">/*Change to your screen resolution*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenWidth  = <span class="number">320</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenHeight = <span class="number">240</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_disp_draw_buf_t</span> draw_buf;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_color_t</span> buf[ screenWidth * <span class="number">10</span> ];</span><br><span class="line">TFT_eSPI tft = <span class="built_in">TFT_eSPI</span>(screenWidth, screenHeight); <span class="comment">/* TFT instance */</span></span><br><span class="line"><span class="comment">/* Display flushing */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_disp_flush</span><span class="params">( <span class="type">lv_disp_drv_t</span> *disp, <span class="type">const</span> <span class="type">lv_area_t</span> *area, <span class="type">lv_color_t</span> *color_p )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> w = ( area-&gt;x2 - area-&gt;x1 + <span class="number">1</span> );</span><br><span class="line">    <span class="type">uint32_t</span> h = ( area-&gt;y2 - area-&gt;y1 + <span class="number">1</span> );</span><br><span class="line">    tft.<span class="built_in">startWrite</span>();</span><br><span class="line">    tft.<span class="built_in">setAddrWindow</span>( area-&gt;x1, area-&gt;y1, w, h );</span><br><span class="line">    tft.<span class="built_in">pushColors</span>( ( <span class="type">uint16_t</span> * )&amp;color_p-&gt;full, w * h, <span class="literal">true</span> );</span><br><span class="line">    tft.<span class="built_in">endWrite</span>();</span><br><span class="line">    <span class="built_in">lv_disp_flush_ready</span>( disp );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*Read the touchpad*/</span></span><br><span class="line"><span class="comment">// void my_touchpad_read( lv_indev_drv_t * indev_driver, lv_indev_data_t * data )</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     uint16_t touchX, touchY;</span></span><br><span class="line"><span class="comment">//     bool touched = tft.getTouch( &amp;touchX, &amp;touchY, 600 );</span></span><br><span class="line"><span class="comment">//     if( !touched )</span></span><br><span class="line"><span class="comment">//     &#123;</span></span><br><span class="line"><span class="comment">//         data-&gt;state = LV_INDEV_STATE_REL;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     else</span></span><br><span class="line"><span class="comment">//     &#123;</span></span><br><span class="line"><span class="comment">//         data-&gt;state = LV_INDEV_STATE_PR;</span></span><br><span class="line"><span class="comment">//         /*Set the coordinates*/</span></span><br><span class="line"><span class="comment">//         data-&gt;point.x = touchX;</span></span><br><span class="line"><span class="comment">//         data-&gt;point.y = touchY;</span></span><br><span class="line"><span class="comment">//         Serial.print( &quot;Data x &quot; );</span></span><br><span class="line"><span class="comment">//         Serial.println( touchX );</span></span><br><span class="line"><span class="comment">//         Serial.print( &quot;Data y &quot; );</span></span><br><span class="line"><span class="comment">//         Serial.println( touchY );</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Serial.<span class="built_in">begin</span>( <span class="number">115200</span> ); <span class="comment">/* prepare for possible serial debug */</span></span><br><span class="line">    String LVGL_Arduino = <span class="string">&quot;Hello Arduino! &quot;</span>;</span><br><span class="line">    LVGL_Arduino += <span class="built_in">String</span>(<span class="string">&#x27;V&#x27;</span>) + <span class="built_in">lv_version_major</span>() + <span class="string">&quot;.&quot;</span> + <span class="built_in">lv_version_minor</span>() + <span class="string">&quot;.&quot;</span> + <span class="built_in">lv_version_patch</span>();</span><br><span class="line">    Serial.<span class="built_in">println</span>( LVGL_Arduino );</span><br><span class="line">    Serial.<span class="built_in">println</span>( <span class="string">&quot;I am LVGL_Arduino&quot;</span> );</span><br><span class="line">    <span class="built_in">lv_init</span>();</span><br><span class="line">    tft.<span class="built_in">begin</span>();          <span class="comment">/* TFT init */</span></span><br><span class="line">    tft.<span class="built_in">setRotation</span>( <span class="number">3</span> ); <span class="comment">/* Landscape orientation, flipped */</span></span><br><span class="line">    <span class="comment">/*Set the touchscreen calibration data,</span></span><br><span class="line"><span class="comment">     the actual data for your display can be acquired using</span></span><br><span class="line"><span class="comment">     the Generic -&gt; Touch_calibrate example from the TFT_eSPI library*/</span></span><br><span class="line">    <span class="type">uint16_t</span> calData[<span class="number">5</span>] = &#123; <span class="number">275</span>, <span class="number">3620</span>, <span class="number">264</span>, <span class="number">3532</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="comment">// tft.setTouch( calData );</span></span><br><span class="line">    <span class="built_in">lv_disp_draw_buf_init</span>( &amp;draw_buf, buf, <span class="literal">NULL</span>, screenWidth * <span class="number">10</span> );</span><br><span class="line">    <span class="comment">/*Initialize the display*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_disp_drv_t</span> disp_drv;</span><br><span class="line">    <span class="built_in">lv_disp_drv_init</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Change the following line to your display resolution*/</span></span><br><span class="line">    disp_drv.hor_res = screenWidth;</span><br><span class="line">    disp_drv.ver_res = screenHeight;</span><br><span class="line">    disp_drv.flush_cb = my_disp_flush;</span><br><span class="line">    disp_drv.draw_buf = &amp;draw_buf;</span><br><span class="line">    <span class="built_in">lv_disp_drv_register</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Initialize the (dummy) input device driver*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_indev_drv_t</span> indev_drv;</span><br><span class="line">    <span class="built_in">lv_indev_drv_init</span>( &amp;indev_drv );</span><br><span class="line">    indev_drv.type = LV_INDEV_TYPE_POINTER;</span><br><span class="line">    <span class="comment">// indev_drv.read_cb = my_touchpad_read;</span></span><br><span class="line">    <span class="built_in">lv_indev_drv_register</span>( &amp;indev_drv );</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="comment">/* Create simple label */</span></span><br><span class="line">    <span class="type">lv_obj_t</span> *label = <span class="built_in">lv_label_create</span>( <span class="built_in">lv_scr_act</span>() );</span><br><span class="line">    <span class="built_in">lv_label_set_text</span>( label, LVGL_Arduino.<span class="built_in">c_str</span>() );</span><br><span class="line">    <span class="built_in">lv_obj_align</span>( label, LV_ALIGN_CENTER, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    <span class="built_in">lv_demo_widgets</span>();            <span class="comment">// OK</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    Serial.<span class="built_in">println</span>( <span class="string">&quot;Setup done&quot;</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">lv_timer_handler</span>(); <span class="comment">/* let the GUI do its work */</span></span><br><span class="line">    <span class="built_in">delay</span>( <span class="number">5</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="编译下载"><a href="#编译下载" class="headerlink" title="编译下载"></a>编译下载</h2><p>显示效果如下图<br><img src="/posts/2c4e27ec/image-20240410134038409.png"></p>
<h1 id="触摸测试"><a href="#触摸测试" class="headerlink" title="触摸测试"></a><font style="color: #26c492">触摸测试</font></h1><h2 id="添加bb-captouch"><a href="#添加bb-captouch" class="headerlink" title="添加bb_captouch"></a>添加<code>bb_captouch</code></h2><p><img src="/posts/2c4e27ec/bb_captouch.png"></p>
<h2 id="修改main-cpp-1"><a href="#修改main-cpp-1" class="headerlink" title="修改main.cpp"></a>修改<code>main.cpp</code></h2><ul>
<li><p>添加头文件</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bb_captouch.h&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置触摸芯片引脚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// These defines are for a low cost ESP32 LCD board with the GT911 touch controller</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SDA  4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SCL  2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_INT 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_RST 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置参数</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">BBCapTouch bbct;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *szNames[] = &#123;<span class="string">&quot;Unknown&quot;</span>, <span class="string">&quot;FT6x36&quot;</span>, <span class="string">&quot;GT911&quot;</span>, <span class="string">&quot;CST820&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">bbct.<span class="built_in">init</span>(TOUCH_SDA, TOUCH_SCL, TOUCH_RST, TOUCH_INT);</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改<code>my_touchpad_read</code>函数</p>
<p>这里的x,y坐标需要根据实际情况修改</p>
<p><img src="/posts/2c4e27ec/pos.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*Read the touchpad*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_touchpad_read</span><span class="params">( <span class="type">lv_indev_drv_t</span> * indev_driver, <span class="type">lv_indev_data_t</span> * data )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TOUCHINFO ti;</span><br><span class="line">    <span class="keyword">if</span>(bbct.<span class="built_in">getSamples</span>(&amp;ti))</span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_PR;</span><br><span class="line">        <span class="comment">/*Set the coordinates*/</span></span><br><span class="line">        data-&gt;point.x = screenWidth - ti.y[<span class="number">0</span>];</span><br><span class="line">        data-&gt;point.y = ti.x[<span class="number">0</span>];</span><br><span class="line">        Serial.<span class="built_in">print</span>( <span class="string">&quot;Data x &quot;</span> );</span><br><span class="line">        Serial.<span class="built_in">println</span>( screenWidth - ti.y[<span class="number">0</span>] );</span><br><span class="line">        Serial.<span class="built_in">print</span>( <span class="string">&quot;Data y &quot;</span> );</span><br><span class="line">        Serial.<span class="built_in">println</span>( ti.x[<span class="number">0</span>] );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_REL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="修改完成-1"><a href="#修改完成-1" class="headerlink" title="修改完成"></a>修改完成</h2><p>最终<code>main.cpp</code>文件内容如下</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lvgl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TFT_eSPI.h&gt;</span> <span class="comment">// Hardware-specific library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;demos/lv_demos.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bb_captouch.h&gt;</span></span></span><br><span class="line"><span class="comment">// These defines are for a low cost ESP32 LCD board with the GT911 touch controller</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SDA  4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_SCL  2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_INT 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOUCH_RST 1</span></span><br><span class="line">BBCapTouch bbct;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *szNames[] = &#123;<span class="string">&quot;Unknown&quot;</span>, <span class="string">&quot;FT6x36&quot;</span>, <span class="string">&quot;GT911&quot;</span>, <span class="string">&quot;CST820&quot;</span>&#125;;</span><br><span class="line"><span class="comment">/*Change to your screen resolution*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenWidth  = <span class="number">320</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint16_t</span> screenHeight = <span class="number">240</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_disp_draw_buf_t</span> draw_buf;</span><br><span class="line"><span class="type">static</span> <span class="type">lv_color_t</span> buf[ screenWidth * <span class="number">10</span> ];</span><br><span class="line">TFT_eSPI tft = <span class="built_in">TFT_eSPI</span>(screenWidth, screenHeight); <span class="comment">/* TFT instance */</span></span><br><span class="line"><span class="comment">/* Display flushing */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_disp_flush</span><span class="params">( <span class="type">lv_disp_drv_t</span> *disp, <span class="type">const</span> <span class="type">lv_area_t</span> *area, <span class="type">lv_color_t</span> *color_p )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> w = ( area-&gt;x2 - area-&gt;x1 + <span class="number">1</span> );</span><br><span class="line">    <span class="type">uint32_t</span> h = ( area-&gt;y2 - area-&gt;y1 + <span class="number">1</span> );</span><br><span class="line">    tft.<span class="built_in">startWrite</span>();</span><br><span class="line">    tft.<span class="built_in">setAddrWindow</span>( area-&gt;x1, area-&gt;y1, w, h );</span><br><span class="line">    tft.<span class="built_in">pushColors</span>( ( <span class="type">uint16_t</span> * )&amp;color_p-&gt;full, w * h, <span class="literal">true</span> );</span><br><span class="line">    tft.<span class="built_in">endWrite</span>();</span><br><span class="line">    <span class="built_in">lv_disp_flush_ready</span>( disp );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*Read the touchpad*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">my_touchpad_read</span><span class="params">( <span class="type">lv_indev_drv_t</span> * indev_driver, <span class="type">lv_indev_data_t</span> * data )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// uint16_t touchX, touchY;</span></span><br><span class="line">    TOUCHINFO ti;</span><br><span class="line">    <span class="keyword">if</span>(bbct.<span class="built_in">getSamples</span>(&amp;ti))</span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_PR;</span><br><span class="line">        <span class="comment">/*Set the coordinates*/</span></span><br><span class="line">        data-&gt;point.x = screenWidth - ti.y[<span class="number">0</span>];</span><br><span class="line">        data-&gt;point.y = ti.x[<span class="number">0</span>];</span><br><span class="line">        Serial.<span class="built_in">print</span>( <span class="string">&quot;Data x &quot;</span> );</span><br><span class="line">        Serial.<span class="built_in">println</span>( screenWidth - ti.y[<span class="number">0</span>] );</span><br><span class="line">        Serial.<span class="built_in">print</span>( <span class="string">&quot;Data y &quot;</span> );</span><br><span class="line">        Serial.<span class="built_in">println</span>( ti.x[<span class="number">0</span>] );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        data-&gt;state = LV_INDEV_STATE_REL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Serial.<span class="built_in">begin</span>( <span class="number">115200</span> ); <span class="comment">/* prepare for possible serial debug */</span></span><br><span class="line">    String LVGL_Arduino = <span class="string">&quot;Hello Arduino! &quot;</span>;</span><br><span class="line">    LVGL_Arduino += <span class="built_in">String</span>(<span class="string">&#x27;V&#x27;</span>) + <span class="built_in">lv_version_major</span>() + <span class="string">&quot;.&quot;</span> + <span class="built_in">lv_version_minor</span>() + <span class="string">&quot;.&quot;</span> + <span class="built_in">lv_version_patch</span>();</span><br><span class="line">    Serial.<span class="built_in">println</span>( LVGL_Arduino );</span><br><span class="line">    Serial.<span class="built_in">println</span>( <span class="string">&quot;I am LVGL_Arduino&quot;</span> );</span><br><span class="line">    <span class="built_in">lv_init</span>();</span><br><span class="line">    tft.<span class="built_in">begin</span>();          <span class="comment">/* TFT init */</span></span><br><span class="line">    tft.<span class="built_in">setRotation</span>( <span class="number">3</span> ); <span class="comment">/* Landscape orientation, flipped */</span></span><br><span class="line">    bbct.<span class="built_in">init</span>(TOUCH_SDA, TOUCH_SCL, TOUCH_RST, TOUCH_INT);</span><br><span class="line">    <span class="type">int</span> iType = bbct.<span class="built_in">sensorType</span>();</span><br><span class="line">    Serial.<span class="built_in">printf</span>(<span class="string">&quot;Sensor type = %s\n&quot;</span>, szNames[iType]);</span><br><span class="line">    <span class="built_in">lv_disp_draw_buf_init</span>( &amp;draw_buf, buf, <span class="literal">NULL</span>, screenWidth * <span class="number">10</span> );</span><br><span class="line">    <span class="comment">/*Initialize the display*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_disp_drv_t</span> disp_drv;</span><br><span class="line">    <span class="built_in">lv_disp_drv_init</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Change the following line to your display resolution*/</span></span><br><span class="line">    disp_drv.hor_res = screenWidth;</span><br><span class="line">    disp_drv.ver_res = screenHeight;</span><br><span class="line">    disp_drv.flush_cb = my_disp_flush;</span><br><span class="line">    disp_drv.draw_buf = &amp;draw_buf;</span><br><span class="line">    <span class="built_in">lv_disp_drv_register</span>( &amp;disp_drv );</span><br><span class="line">    <span class="comment">/*Initialize the (dummy) input device driver*/</span></span><br><span class="line">    <span class="type">static</span> <span class="type">lv_indev_drv_t</span> indev_drv;</span><br><span class="line">    <span class="built_in">lv_indev_drv_init</span>( &amp;indev_drv );</span><br><span class="line">    indev_drv.type = LV_INDEV_TYPE_POINTER;</span><br><span class="line">    indev_drv.read_cb = my_touchpad_read;</span><br><span class="line">    <span class="built_in">lv_indev_drv_register</span>( &amp;indev_drv );</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="comment">/* Create simple label */</span></span><br><span class="line">    <span class="type">lv_obj_t</span> *label = <span class="built_in">lv_label_create</span>( <span class="built_in">lv_scr_act</span>() );</span><br><span class="line">    <span class="built_in">lv_label_set_text</span>( label, LVGL_Arduino.<span class="built_in">c_str</span>() );</span><br><span class="line">    <span class="built_in">lv_obj_align</span>( label, LV_ALIGN_CENTER, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    <span class="comment">// uncomment one of these demos</span></span><br><span class="line">    <span class="built_in">lv_demo_widgets</span>();            <span class="comment">// OK</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    Serial.<span class="built_in">println</span>( <span class="string">&quot;Setup done&quot;</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">lv_timer_handler</span>(); <span class="comment">/* let the GUI do its work */</span></span><br><span class="line">    <span class="built_in">delay</span>( <span class="number">5</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="编译下载-1"><a href="#编译下载-1" class="headerlink" title="编译下载"></a>编译下载</h2><p>触摸显示效果如下图所示<br><img src="/posts/2c4e27ec/image-20240410134339063.png"></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><center> 2024 <font color="#00bcd9">Levi5</font></center>
]]></content>
      <categories>
        <category>ESP32</category>
        <category>教程</category>
      </categories>
      <tags>
        <tag>ESP32</tag>
        <tag>PlatformIO</tag>
        <tag>lvgl</tag>
        <tag>2.8寸TFT</tag>
        <tag>触摸屏</tag>
        <tag>立创</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/4a17b156/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<p>Hexo 是一个基于 Node.js 的快速、简洁且高效的博客框架。它使用 Markdown（或其他渲染器）解析文章，然后生成静态网页。</p>
<h1 id="创建新博文"><a href="#创建新博文" class="headerlink" title="创建新博文"></a>创建新博文</h1><p>在博客目录下，运行以下命令来创建新博文：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">&quot;My_New_Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>将在 <code>source/_posts</code> 目录下创建一个名为 <code>My_New_Post.md</code> 的 Markdown 文件</p>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h1 id="编写博文"><a href="#编写博文" class="headerlink" title="编写博文"></a>编写博文</h1><p>打开 <code>source/_posts/My_New_Post.md</code> 文件，在其中编写博文内容。一个基本的博文格式如下：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: My<span class="emphasis">_New_</span>Post</span><br><span class="line">date: 2024-01-01 00:00:00</span><br><span class="line">tags: </span><br><span class="line"><span class="bullet">	-</span> 标签1</span><br><span class="line"><span class="bullet">	-</span> 标签2</span><br><span class="line">categories: </span><br><span class="line"><span class="bullet">	-</span> 分类1</span><br><span class="line">author: Levi5</span><br><span class="line"><span class="section">description: My<span class="emphasis">_New_</span>Post</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line">这里是博文内容</span><br></pre></td></tr></table></figure>

<ul>
<li><code>title</code>: 博文标题</li>
<li><code>date</code>: 博文日期</li>
<li><code>tags</code>: 博文标签，可选</li>
<li><code>categories</code>: 博文分类，可选</li>
<li><code>author</code>: 作者，可选</li>
<li><code>description</code>: 博文描述，可选</li>
<li>博文内容: Markdown 格式的正文内容</li>
</ul>
<h1 id="启动本地服务器"><a href="#启动本地服务器" class="headerlink" title="启动本地服务器"></a>启动本地服务器</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure>
<p>或简写为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>然后在浏览器中访问 <code>http://localhost:4000</code> 查看博文</p>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h1 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure>
<p>或简写为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h1 id="部署到远程服务器"><a href="#部署到远程服务器" class="headerlink" title="部署到远程服务器"></a>部署到远程服务器</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
<p>或简写为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>使用指南</category>
      </categories>
      <tags>
        <tag>使用指南</tag>
        <tag>软件</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
</search>
